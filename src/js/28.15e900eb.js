(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"7aa3":function(t,e,a){},bf8b:function(t,e,a){"use strict";var s=a("7aa3"),r=a.n(s);r.a},e4b7:function(t,e,a){},f0d1:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.getGlobalSubject?a("div",[a("div",{staticClass:"full-width bg-secondary",staticStyle:{height:"1px"}}),a("toolbar-page",{staticClass:"t-bar",attrs:{elements:t.elements,default:"wyap"},scopedSlots:t._u([{key:"before",fn:function(){return[a("year-bar",{staticClass:"yb-border",attrs:{exams:""}})]},proxy:!0}],null,!1,311916022)})],1):t._e()},r=[],n=(a("e125"),a("4823"),a("2e73"),a("76d0"),a("7f3a")),i=a.n(n),o=a("8e9e"),c=a.n(o),l=a("9ce4"),d=a("aba1"),u=a("89cf"),h=a("08e9"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("loading",{attrs:{loading:t.loading,channel:"hod.metrics.wyaps"}}),t.loading?t._e():a("div",{staticClass:"row no-wrap q-px-xs q-pt-none text-left",staticStyle:{"padding-bottom":"200px"}},[a("div",{staticClass:"q-mr-md",staticStyle:{"min-width":"200px"}},[a("q-scroll-area",{staticClass:"bg-tertiary",staticStyle:{height:"80vh"}},[a("q-list",{},[a("q-item",{staticClass:"text-font-secondary",attrs:{dense:"",clickable:""},on:{click:function(e){t.newOpen=!0}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-plus",size:"xs",color:"positive"}})],1),a("q-item-section",[a("q-item-label",[t._v("Create New")])],1)],1),a("q-separator",{attrs:{color:"text-primary"}}),t._l(t.wyaps,(function(e){return a("div",{key:e.id},[a("q-item",{staticClass:"q-pa-xs text-white bg-tertiary q-my-xs",class:e.id===t.selectedWyapId?"active-class":"",attrs:{clickable:"",group:"wyaps"},on:{click:function(a){return t.setWyap(e.id)}}},[a("q-item-section",[a("q-item-label",{staticClass:"q-pl-sm text-font"},[t._v("\n                    "+t._s(e.name)+"\n                  ")])],1),a("q-item-section",{attrs:{side:""}},[a("q-icon",{attrs:{name:"fas fa-chevron-right",color:"font-secondary",size:"xs"}})],1)],1)],1)}))],2)],1)],1),a("div",{staticClass:"col no-scroll"},[t.wyap?a("q-toolbar",{staticClass:"bg-tertiary text-white no-padding",staticStyle:{"max-height":"38px","min-height":"38px","border-bottom":"1px solid black"},attrs:{shrink:"",dense:""}},[a("q-tabs",{attrs:{stretch:"","active-color":"accent",dense:""},model:{value:t.wyapTab,callback:function(e){t.wyapTab=e},expression:"wyapTab"}},[a("q-tab",{attrs:{name:"results",label:"results"}}),a("q-tab",{attrs:{name:"analysis",label:"analysis"}})],1),a("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",label:"update",color:"font-secondary",dense:""},on:{click:t.openUpdate}})],1):t._e(),t.wyap?a("q-tab-panels",{staticStyle:{height:"80vh"},attrs:{animated:""},model:{value:t.wyapTab,callback:function(e){t.wyapTab=e},expression:"wyapTab"}},[a("q-tab-panel",{staticClass:"q-px-none",attrs:{name:"results"}},[a("results",{attrs:{results:t.results,wyap:t.wyap}})],1),a("q-tab-panel",{attrs:{name:"analysis"}},[a("div",{staticClass:"text-h6"},[t._v("Data Visualisation")]),t._v("\n          Coming soon ...\n        ")]),a("q-tab-panel",{staticClass:"q-px-none fit",attrs:{name:"update",stylex:"height:60vh"}},[a("update",{attrs:{results:t.results}})],1)],1):t._e()],1)]),a("q-dialog",{attrs:{persistent:""},model:{value:t.newOpen,callback:function(e){t.newOpen=e},expression:"newOpen"}},[a("q-card",{staticClass:"bd-font-secondary bg-secondary",staticStyle:{"min-width":"300px"}},[a("q-card-section",{staticClass:"row items-center bg-tertiary"},[a("div",{staticClass:"text-h7 text-font-secondary"},[t._v("Create New Wyap")])]),a("q-separator"),a("q-card-section",{staticClass:"row items-center"},[a("q-input",{staticClass:"full-width",attrs:{color:"font-secondary",label:"Name","stacked-label":""},model:{value:t.newWyap.name,callback:function(e){t.$set(t.newWyap,"name",e)},expression:"newWyap.name"}}),a("q-input",{staticClass:"full-width",attrs:{color:"font-secondary",label:"Out of how many marks?","stacked-label":"",type:"number"},model:{value:t.newWyap.marks,callback:function(e){t.$set(t.newWyap,"marks",e)},expression:"newWyap.marks"}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"font"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:0===t.newWyap.name.length||!t.newWyap.marks,flat:"",label:"CREATE",color:"accent"},on:{click:t.createNew}})],1)],1)],1),t.wyap?a("q-dialog",{key:t.key,staticStyle:{height:"100vh"},attrs:{persistent:"",maximized:t.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.updateOpen,callback:function(e){t.updateOpen=e},expression:"updateOpen"}},[a("q-card",{staticClass:"bg-primary bd-font-secondary text-white column",staticStyle:{"overflow-y":"hidden","min-width":"500px",height:"90vh"}},[a("update",{staticClass:"col",attrs:{results:t.results,id:t.wyap.id,name:t.wyap.name,marks:t.wyap.marks},on:{close:function(e){t.updateOpen=!1},refresh:t.refresh}})],1)],1):t._e()],1)},m=[],b=a("47783"),y=a("452d"),f={getWyaps(t,e,a,s){var r=y["a"].getters["user/getGlobalSubject"];b["a"].get("/hod/"+r.id+"/wyaps/"+a+"/"+s).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},postWyap(t,e,a,s,r){var n=y["a"].getters["user/getGlobalSubject"];b["a"].post("/hod/"+n.id+"/wyaps/"+a+"/"+s,r).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},putWyap(t,e,a){var s=y["a"].getters["user/getGlobalSubject"];b["a"].put("/hod/"+s.id+"/wyaps/"+a.id,a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},deleteWyap(t,e,a){var s=y["a"].getters["user/getGlobalSubject"];b["a"].put("/hod/"+s.id+"/wyaps/"+a.id).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getWyapResults(t,e,a){var s=y["a"].getters["user/getGlobalSubject"];b["a"].get("/hod/"+s.id+"/wyaps/"+a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}},g=a("10ac"),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pr-sm",staticStyle:{"overflow-y":"scroll"}},[a("div",{staticClass:"row fit"},[a("div",{staticClass:"col q-mt-md"},[a("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[a("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[a("thead",{staticClass:"q-mb-md"},[a("tr",{staticClass:"bg-tertiary"},[a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("name")}}},[t._v("Name")]),a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("boarding")}}},[t._v("Hs")]),a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("classCode")}}},[t._v("Class")]),a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("mark")}}},[t._v("Mark / "+t._s(t.wyap.marks))]),a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("percentage")}}},[t._v("%")]),a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("rank")}}},[t._v("Rank")]),a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("flag")}}},[t._v("Flag")]),a("th")])]),a("tbody",{on:{onpaste:t.paste}},t._l(t.sorted,(function(e){return a("tr",{key:e.id,on:{onpaste:t.paste}},[a("td",{staticClass:"text-left"},[t._v(t._s(e.lastName+",  "+e.preName))]),a("td",{staticClass:"text-left"},[t._v(t._s(e.boarding))]),a("td",{staticClass:"text-left"},[t._v(t._s(e.classCode))]),a("td",{staticClass:"text-left"},[t._v(t._s(e.mark))]),a("td",{staticClass:"text-left"},[t._v(t._s(e.percentage))]),a("td",{staticClass:"text-left"},[t._v(t._s(e.rank))]),a("td",{staticClass:"text-left"}),a("td",{staticClass:"text-left"})])})),0)])],1)],1)])])},x=[],w=(a("632c"),{name:"hods.metrics.wyaps.results",props:{results:{type:Array,required:!0},wyap:{type:Object,required:!0}},data(){return{students:[],search:"",loading:!0,dates:[],sortKey:"lastName",sortDir:"asc"}},methods:{setSort(t){t===this.sortKey&&(this.sortDir="asc"===this.sortDir?"desc":"asc"),this.sortKey=t},paste(t){console.warn(t)}},computed:{visible(){return this.results},sorted(){var t=this.visible.filter((function(t){return t.id>0}));return console.log(t),t.sort(this.$compare(this.sortKey,this.sortDir))}},watch:{results(){}},components:{},created(){}}),k=w,C=a("2be6"),q=a("bc74"),_=a("26a8"),S=a("2e0b"),W=a("e279"),j=a.n(W),O=Object(C["a"])(k,v,x,!1,null,"ef5bdbb4",null),$=O.exports;j()(O,"components",{QInput:q["a"],QScrollArea:_["a"],QMarkupTable:S["a"]});var Q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none full-width column",staticStyle:{"overflow-y":"hidden"}},[a("q-bar",{staticClass:"bg-tertiary bd-font-secondary",staticStyle:{height:"50px"}},[a("q-input",{staticClass:"full-width bg-tertiary text-center q-pl-sm",staticStyle:{"font-size":"13px","max-height":"39px"},attrs:{size:"xs",color:"font-secondary","hide-bottom-space":"",borderless:""},on:{input:t.changed},model:{value:t.newName,callback:function(e){t.newName=e},expression:"newName"}}),a("q-space"),a("q-input",{staticClass:"full-width bg-tertiary text-center q-pl-sm",staticStyle:{"font-size":"13px","max-height":"39px","max-width":"80px"},attrs:{size:"xs",label:"marks /",color:"font-secondary","hide-bottom-space":"",borderless:""},on:{input:t.changed},model:{value:t.newMarks,callback:function(e){t.newMarks=e},expression:"newMarks"}})],1),t.hasErrors?a("q-banner",{staticClass:"text-font-negative bg-warning q-py-xs",attrs:{"inline-actions":""}},[a("ul",t._l(t.errors,(function(e,s){return a("li",{key:s},[t._v(t._s(e))])})),0)]):t._e(),a("q-scroll-area",{staticClass:"col"},[a("q-markup-table",{staticClass:"q-mb-xl",staticStyle:{"overflow-y":"hidden"},attrs:{dense:"",flat:"",bordered:""}},[a("thead",{staticClass:"q-mb-md"},[a("tr",{staticClass:"bg-tertiary"},[a("th"),a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("classCode")}}},[t._v("Class")]),a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("name")}}},[t._v("Name")]),a("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("mark")}}},[t._v("Mark")]),a("th",{staticClass:"text-center",on:{click:function(e){return t.setSort("hasUnderPerformed")}}},[t._v("U/P")]),a("th"),a("th")])]),a("tbody",t._l(t.sorted,(function(e,s){return a("tr",{key:e.id,staticClass:"q-py-lg"},[a("td",[t._v(t._s(s+1))]),a("td",{staticClass:"text-left"},[t._v(t._s(e.classCode))]),a("td",{staticClass:"text-left"},[t._v(t._s(e.lastName+",  "+e.preName))]),a("td",{staticClass:"text-left ada-mark"},[a("q-input",{staticClass:"full-width bg-tertiary text-center q-pl-sm",staticStyle:{"font-size":"13px","min-width":"60px","max-width":"60px","max-height":"25px"},attrs:{size:"xs",color:"font-secondary","hide-bottom-space":"",borderless:""},on:{paste:function(e){return t.onPaste(s,e)},input:t.changed},model:{value:e.mark,callback:function(a){t.$set(e,"mark",t._n(a))},expression:"s.mark"}})],1),a("td",{staticClass:"text-center"},[a("q-toggle",{attrs:{tabindex:"-1",dense:"","checked-icon":"check",color:"warning","unchecked-icon":"clear","true-value":1,"false-value":0},on:{input:function(e){t.hasChanged=!0}},model:{value:e.hasUnderperformed,callback:function(a){t.$set(e,"hasUnderperformed",a)},expression:"s.hasUnderperformed"}})],1),a("td"),a("td",{staticClass:"text-left"})])})),0)])],1),a("q-bar",{staticClass:"bg-tertiary bd-font-secondary",staticStyle:{height:"60px"}},[a("q-btn",{attrs:{color:"warning",label:"delete wyap",flat:"",size:"md"}}),a("q-space"),a("q-btn",{attrs:{label:"close",flat:"",size:"md"},on:{click:t.close}}),a("q-btn",{staticClass:"text-font-negative",attrs:{disable:!t.hasChanged,label:"save",color:"positive",size:"md"},on:{click:t.save}})],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.closeConfirm,callback:function(e){t.closeConfirm=e},expression:"closeConfirm"}},[a("q-card",{staticClass:"bd-font-secondary bg-tertiary"},[a("q-card-section",{staticClass:"row items-center"},[a("span",{staticClass:"q-ml-sm"},[t._v("Sure about this? You have unsaved changes.")])]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Close",color:"font"},on:{click:function(e){return t.$emit("close")}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-font-negative",attrs:{label:"Save",color:"positive"},on:{click:t.save}})],1)],1)],1)],1)},D=[],E=(a("c880"),a("4fb0"),{name:"hods.metrics.wyaps.results",props:{results:{type:Array,required:!0},name:{type:String,required:!0},marks:{type:Number,required:!0},id:{type:Number,required:!0}},data(){return{students:[],search:"",loading:!0,dates:[],sortKey:"lastName",sortDir:"asc",newResults:[],newName:null,newMarks:null,hasChanged:!1,closeConfirm:!1,hasErrors:!1,errors:[]}},methods:{setSort(t){t===this.sortKey&&(this.sortDir="asc"===this.sortDir?"desc":"asc"),this.sortKey=t},onPaste(t,e){e.stopPropagation(),e.preventDefault();var a,s=e.clipboardData.getData("text/plain"),r=s.split("\n");for(a=0;a<r.length;a++)this.sorted[a+t].mark=r[a];return!1},close(){this.hasChanged?this.closeConfirm=!0:this.$emit("close")},verify(){var t=this;this.errors=[],this.hasErrors=!1,0===this.newName.length&&(this.hasErrors=!0,this.errors.push("The title cannot be blank.")),parseInt(this.newMarks)||(this.hasErrors=!0,this.errors.push("The marks make no sense"));var e=this.newResults.filter((function(e){return t.markError(e.mark)}));return e.length>0&&(this.hasErrors=!0,this.errors.push("Marks must be either a number or blank")),0===this.errors.length},save(){var t=this;if(this.verify()){var e={id:this.id,name:this.newName,marks:this.newMarks,results:this.newResults};f.putWyap((function(e){t.$emit("refresh")}),this.$errorHandler,e)}},markError(t){if(t)return"number"!==typeof t},changed(){this.hasChanged=!0,this.verify()}},computed:{visible(){return this.newResults},sorted(){var t=this.visible.filter((function(t){return t.id>0}));return t.sort(this.$compare(this.sortKey,this.sortDir))}},watch:{},components:{},created(){this.newResults=this.results.filter((function(t){return t.id>0})),this.newName=this.name,this.newMarks=this.marks}}),T=E,M=a("5d16"),N=a("f85a"),A=a("f962c"),P=a("01a4"),G=a("3d3c"),H=a("2ef0"),Y=a("e81c"),I=a("ebe6"),z=a("965d"),L=a("5b32"),B=a("58c0"),K=Object(C["a"])(T,Q,D,!1,null,null,null),R=K.exports;j()(K,"components",{QBar:M["a"],QToolbarTitle:N["a"],QInput:q["a"],QSpace:A["a"],QBanner:P["a"],QScrollArea:_["a"],QMarkupTable:S["a"],QToggle:G["a"],QBtn:H["a"],QDialog:Y["a"],QCard:I["a"],QCardSection:z["a"],QCardActions:L["a"]}),j()(K,"directives",{ClosePopup:B["a"]});var F={name:"HOD.Data.Wyaps",props:{},data(){return{loading:!1,wyaps:[],newOpen:!1,newWyap:{name:"",marks:null},selectedWyapId:null,wyapTab:"results",results:[],maximizedToggle:!1,updateOpen:!1,key:1}},methods:{process(t){this.loading=!1,this.wyaps=t},getWyaps(){this.year=this.$store.getters["hod/activeYear"],this.exam=this.$store.getters["hod/activeExam"],this.loading=!0,f.getWyaps(this.process,this.$errorHandler,this.year,this.exam)},createNew(){this.year=this.$store.getters["hod/activeYear"],this.exam=this.$store.getters["hod/activeExam"],f.postWyap(this.processNew,this.$errorHandler,this.year,this.exam,this.newWyap)},processNew(){this.getWyaps(),this.newWyap={name:"",marks:null}},processResults(t){this.results=t.results,this.$q.loading.hide()},setWyap(t){this.selectedWyapId=t},openUpdate(){this.key++,this.updateOpen=!0},getWyap(t){this.$q.loading.show(),f.getWyapResults(this.processResults,this.$errorHandler,t)},refresh(){this.getWyaps(),this.getWyap(this.selectedWyapId),this.updateOpen=!1}},computed:{columns(){var t=[];return t},wyap(){var t=this,e=this.wyaps.find((function(e){return e.id===t.selectedWyapId}));return e}},watch:{selectedWyapId(t){this.getWyap(t)}},components:{Loading:g["a"],Results:$,Update:R},created(){var t=this;this.subject=this.$store.getters["user/getGlobalSubject"],this.getWyaps(),this.subjectWatch=this.$store.watch((function(){return t.$store.getters["user/getGlobalSubject"]}),this.getWyaps),this.yearWatch=this.$store.watch((function(){return t.$store.getters["hod/activeYear"]}),this.getWyaps),this.examWatch=this.$store.watch((function(){return t.$store.getters["hod/activeExam"]}),this.getWyaps)},beforeDestroy(){this.subjectWatch&&this.subjectWatch(),this.yearWatch&&this.yearWatch(),this.examWatch&&this.examWatch()}},U=F,J=(a("bf8b"),a("6c93")),X=a("ac9b"),V=a("66dc"),Z=a("34ff"),tt=a("7d9a"),et=a("96f0"),at=a("8c18"),st=a("eb05"),rt=a("4776"),nt=a("dd08"),it=a("1411"),ot=a("1d98"),ct=Object(C["a"])(U,p,m,!1,null,null,null),lt=ct.exports;j()(ct,"components",{QScrollArea:_["a"],QList:J["a"],QItem:X["a"],QItemSection:V["a"],QIcon:Z["a"],QItemLabel:tt["a"],QSeparator:et["a"],QPopupProxy:at["a"],QBanner:P["a"],QToolbar:st["a"],QTabs:rt["a"],QTab:nt["a"],QBtn:H["a"],QTabPanels:it["a"],QTabPanel:ot["a"],QDialog:Y["a"],QCard:I["a"],QCardSection:z["a"],QInput:q["a"],QCardActions:L["a"]}),j()(ct,"directives",{ClosePopup:B["a"]});var dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("loading",{attrs:{loading:t.loading,channel:"hod.metrics.history"}}),t.loading?t._e():a("history-table",{key:t.componentKey,attrs:{history:t.subject.history,grades:t.subject.grades,bands:t.subject.bands,bandedHistory:t.subject.bandedHistory}}),t.loading?t._e():a("history-stack",{key:t.componentKey,ref:"stack",attrs:{id:"1",profile:t.subject.stackedHistory,grades:t.subject.grades}})],1)},ut=[],ht={getClassMetrics(t,e,a){var s=y["a"].getters["user/getGlobalSubject"];b["a"].get("/hod/"+s.id+"/metrics/class/"+a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getYearMLO(t,e,a,s,r){var n=y["a"].getters["user/getGlobalSubject"];b["a"].get("/hod/"+n.id+"/metrics/year/"+a+"/MLO/"+s,{cancelToken:r}).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getYearMetrics(t,e,a,s,r){var n=y["a"].getters["user/getGlobalSubject"];b["a"].get("/hod/"+n.id+"/metrics/year/"+a+"/metrics/"+s,{cancelToken:r}).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getYearMetricsSpreadsheet(t,e,a,s,r){var n=y["a"].getters["user/getGlobalSubject"];b["a"].get("/hod/"+n.id+"/metrics/year/"+a+"/metrics/"+s+"/spreadsheet",{cancelToken:r}).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getExamHistory(t,e,a,s){var r=y["a"].getters["user/getGlobalSubject"];b["a"].get("/hod/"+r.id+"/metrics/year/"+a+"/history/"+s).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}},pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row"},[a("q-btn-toggle",{staticClass:"col q-ml-xs",attrs:{spread:"","no-caps":"",dense:"",outline:"","toggle-color":"tertiary",color:"secondary","text-color":"font-secondary","toggle-text-color":"accent",options:t.styles,year:"full-width"},model:{value:t.style,callback:function(e){t.style=e},expression:"style"}}),a("q-btn-toggle",{staticClass:"col q-ml-xs",attrs:{outline:"",spread:"","no-caps":"",dense:"","toggle-color":"tertiary",color:"secondary","text-color":"font-secondary","toggle-text-color":"accent",options:t.modes,year:"full-width"},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}})],1),"linear"===t.style?a("q-markup-table",{staticClass:"q-mt-xs q-my-md",attrs:{dense:"",flat:"",bordered:""}},[a("thead",{staticClass:"q-mb-md"},[a("tr",{staticClass:"bg-tertiary"},[a("th",{staticClass:"text-right"},[t._v(t._s("percentage"===t.mode?"%":"Abs"))]),t._l(t.grades,(function(e){return a("th",{key:e.grade},[t._v("\n          "+t._s(e.grade)+"\n          "),"GCSE Avg"===e.grade?a("q-icon",{attrs:{size:"xs",color:"font",name:"fad fa-question-circle"}},[a("q-tooltip",{attrs:{"content-class":"bg-tertiary"}},[t._v("\n              The average GCSE grades of the pupils taking the subject in a given year.\n            ")])],1):t._e()],1)})),a("th")],2)]),a("tbody",t._l(t.history,(function(e){return a("tr",{key:e.year},[a("td",{staticClass:"text-right"},[t._v(t._s(e.year))]),t._l(t.grades,(function(s){return a("td",{key:s.grade,staticClass:"text-center"},[t._v("\n          "+t._s(t.getGrade(s.grade,e))+"\n        ")])})),a("td")],2)})),0)]):t._e(),"banded"===t.style?a("q-markup-table",{staticClass:"q-mt-xs q-my-md",attrs:{dense:"",flat:"",bordered:""}},[a("thead",{staticClass:"q-mb-md"},[a("tr",{staticClass:"bg-tertiary"},[a("th",{staticClass:"text-right"},[t._v(t._s("percentage"===t.mode?"%":"Abs"))]),t._l(t.bands,(function(e){return a("th",{key:e},[t._v("\n          "+t._s(e)+"\n          "),"GCSE Avg"===e?a("q-icon",{attrs:{size:"xs",color:"font",name:"fad fa-question-circle"}},[a("q-tooltip",{attrs:{"content-class":"bg-tertiary"}},[t._v("\n              The average GCSE grades of the pupils taking the subject in a given year.\n            ")])],1):t._e()],1)})),a("th")],2)]),a("tbody",t._l(t.bandedHistory,(function(e){return a("tr",{key:e.year},[a("td",{staticClass:"text-right"},[t._v(t._s(e.year))]),t._l(t.bands,(function(s){return a("td",{key:s.bands,staticClass:"text-center"},[t._v("\n          "+t._s(t.getBandData(s,e))+"\n        ")])})),a("td",["Avg Last 3 Yrs"===e.year?a("q-icon",{attrs:{size:"xs",color:"font",name:"fad fa-question-circle"}},[a("q-tooltip",{attrs:{"content-class":"bg-tertiary"}},[t._v("\n              Last 3 (if available) year's grades are treated as a single cohort with the final absolute values divided by 3.\n            ")])],1):t._e()],1)],2)})),0)]):t._e()],1)},mt=[],bt={name:"HOD.Metrics.MLO.ProfileTable",props:{history:{type:Array,required:!0},bandedHistory:{type:Array,required:!0},grades:{type:Array,required:!0},bands:{type:Array,required:!0},title:{tyle:String,default:""}},data(){return{mode:"percentage",modes:[{value:"percentage",label:"Percentage"},{value:"absolute",label:"Absolute"}],style:"banded",styles:[{value:"banded",label:"Banded"},{value:"linear",label:"Linear"}]}},computed:{ordered(){return parseInt(this.profile[0])<7?this.profile.split().reverse():this.profile}},methods:{getGrade(t,e){var a=e.results.find((function(e){return e.grade===t}));return a?"absolute"===this.mode||"GCSE Avg"===t?a.count:a.pct:"-"},getBandData(t,e){var a=e.results.find((function(e){return e.band===t}));if(!a)return"-";var s="absolute"===this.mode?a.abs:a.pct;return 0===s?"":s}},watch:{},components:{},created(){}},yt=bt,ft=a("6dd6"),gt=a("3aaf"),vt=Object(C["a"])(yt,pt,mt,!1,null,"5191f8cd",null),xt=vt.exports;j()(vt,"components",{QBtnToggle:ft["a"],QMarkupTable:S["a"],QIcon:Z["a"],QTooltip:gt["a"]});var wt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{ref:"stacked",staticStyle:{height:"200px"}})])},kt=[],Ct=a("915b"),qt=a("3099"),_t=a("3903");Ct["f"](_t["a"]);var St={name:"HOD.Metrics.MLO.HistoryStack",props:{profile:{type:Array,required:!0},grades:{type:Array,required:!0},title:{tyle:String,default:""}},data(){return{stacked:null,chart:null}},methods:{createStacked(){var t=Ct["c"](this.$refs.stacked,qt["l"]);this.stacked=t,t.hiddenState.properties.opacity=0,t.colors.step=4,t.padding(10,10,10,10);var e=t.xAxes.push(new qt["a"]);e.dataFields.category="year",e.renderer.grid.template.location=0,e.renderer.minGridDistance=50;var a=t.yAxes.push(new qt["k"]);a.min=0,a.max=100,a.strictMinMax=!0,a.calculateTotals=!0,a.renderer.minWidth=50,t.data=this.stackData()},addStackSeries(t,e){var a=t.series.push(new qt["c"]);a.sequencedInterpolation=!0,a.columns.template.width=Ct["e"](80),a.columns.template.tooltipText="[bold]{name}[/][font-size:14px]: {valueY.totalPercent.formatNumber('#.00')}%",a.name=e,a.dataFields.categoryX="year",a.dataFields.valueY=e,a.dataFields.valueYShow="totalPercent",a.dataItems.template.locations.categoryX=.5,a.stacked=!0,a.tooltip.pointerOrientation="vertical";var s=this.getColor(e);a.fill=Ct["b"](s)},getColor(t){var e="";switch(t){case"9":case"D1":e="#FF00FF";break;case"D2":case"A*":case"8":e="#9900ff";break;case"D3":case"A":case"7":e="#0000ff";break;case"M1":case"B":case"6":e="#4a86e8";break;case"M2":case"C":case"5":e="#00ffff";break;case"M3":case"D":case"4":e="#00ff00";break;case"P1":case"E":case"3":e="#ffff00";break;case"P2":case"2":e="#ff9900";break;case"U":e="#ff0000";break;default:e="#980000"}return e},stackData(){var t=this;return this.grades.forEach((function(e){Number.isInteger(e.grade)||t.stacked.colors.reset(),"GCSE Avg"!==e.grade&&t.addStackSeries(t.stacked,e.grade)})),this.profile}},computed:{},watch:{},components:{},created(){},mounted(){this.createStacked()},beforeDestroy(){this.stacked.dispose()}},Wt=St,jt=Object(C["a"])(Wt,wt,kt,!1,null,"5e19ad04",null),Ot=jt.exports,$t=a("8206"),Qt=a.n($t),Dt={name:"HOD.Data.MLO",props:{},data(){return{year:null,exam:null,subject:null,students:[],maxMLOCount:4,splitter:60,loading:!0,request:null,componentKey:1}},methods:{process(t){t.year===this.year&&t.id===this.subject.id&&t.examId===this.exam&&(this.componentKey++,this.students=t.students,this.maxMLOCount=t.maxMLOCount,this.subject=t,this.loading=!1)},getHistory(){this.loading=!0,this.request&&this.request.cancel(),this.request=Qt.a.CancelToken.source(),this.year=this.$store.getters["hod/activeYear"],this.exam=this.$store.getters["hod/activeExam"],this.subject=this.$store.getters["user/getGlobalSubject"],ht.getExamHistory(this.process,this.$errorFunction,this.year,this.exam,this.request)}},computed:{},watch:{},components:{HistoryTable:xt,HistoryStack:Ot,Loading:g["a"]},created(){var t=this;this.subject=this.$store.getters["user/getGlobalSubject"],this.getHistory(),this.subWatch=this.$store.watch((function(){return t.$store.getters["user/getGlobalSubject"]}),this.getHistory),this.yearWatch=this.$store.watch((function(){return t.$store.getters["hod/activeYear"]}),this.getHistory),this.examWatch=this.$store.watch((function(){return t.$store.getters["hod/activeExam"]}),this.getHistory)},beforeDestroy(){this.subWatch(),this.yearWatch(),this.examWatch()}},Et=Dt,Tt=(a("f1e9"),Object(C["a"])(Et,dt,ut,!1,null,"7c11e2db",null)),Mt=Tt.exports;function Nt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function At(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(a),!0).forEach((function(e){c()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Nt(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var Pt={name:"Page.HOD.Metrics",data(){return{elements_:[{name:"wyap",label:"wyap",component:lt,tooltip:"Whole Year Assessment Point"}]}},computed:At(At(At({},Object(l["c"])("user",["getGlobalSubject"])),Object(l["c"])("hod",["activeYear"])),{},{elements(){var t=[{name:"history",label:"history",component:Mt}];return t=[],11===this.activeYear||13===this.activeYear?[].concat(i()(this.elements_),i()(t)):this.elements_}}),methods:At({},Object(l["d"])("hod",["setActiveYear"])),components:{toolbarPage:h["a"],YearBar:d["a"],ExamBar:u["a"]},created(){var t=this;this.setActiveYear(13),this.subjectWatch=this.$store.watch((function(){return t.$store.getters["user/getGlobalSubject"]}),this.setClass),this.yearWatch=this.$store.watch((function(){return t.$store.getters["hod/activeYear"]}),this.setClass)},beforeDestroy(){this.subjectWatch&&this.subjectWatch(),this.yearWatch&&this.yearWatch()}},Gt=Pt,Ht=Object(C["a"])(Gt,s,r,!1,null,null,null);e["default"]=Ht.exports},f1e9:function(t,e,a){"use strict";var s=a("e4b7"),r=a.n(s);r.a}}]);