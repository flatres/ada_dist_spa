(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[56],{2914:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"no-scroll full-height toolbar-page "},[s("div",{staticClass:" q-ma-lg",staticStyle:{"overflow-y":"scroll"}},[s("div",{staticClass:"row"},[s("q-btn-toggle",{staticClass:"text-positive q-mr-lg",attrs:{outline:"","text-color":"font-secondary","toggle-text-color":"positive",options:[{label:"All",value:"all"},{label:"Alert Today",value:"alert_today"},{label:"Any Alert",value:"alert_any"}]},model:{value:t.filterModel,callback:function(e){t.filterModel=e},expression:"filterModel"}}),s("q-input",{staticClass:"col",attrs:{dense:"",outline:"",color:"font",placeholder:"Search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),s("div",{staticClass:"row fit"},[s("div",{staticClass:"col q-mt-md"},[s("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[t.loading?t._e():s("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[s("thead",{staticClass:"q-mb-md"},[s("tr",{staticClass:"bg-tertiary"},[s("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("name")}}},[t._v("Name")]),s("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("NCYear")}}},[t._v("Yr")]),t._l(t.dates,(function(e){return s("th",{key:e.date,staticClass:"text-left"},[t._v(t._s(e.prettyDate))])})),s("th",{staticClass:"text-left"})],2)]),s("tbody",t._l(t.sorted,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[t._v(t._s(e.lastname+",  "+e.prename))]),s("td",{staticClass:"text-left"},[t._v(t._s(e.NCYear))]),t._l(t.dates,(function(t){return s("td",{key:t.date,staticClass:"text-left"},[s("answer",{attrs:{person:e,date:t.date}})],1)})),s("td",{staticClass:"text-left"})],2)})),0)])],1)],1)])])])},r=[],l=(s("632c"),s("1bfa")),o=s("0142"),i={name:"smt.covid.students",props:{},data(){return{students:[],search:"",filterModel:"all",loading:!0,dates:[],sortKey:"lastname",sortDir:"asc",house:null}},methods:{process(t){this.$q.loading.hide(),this.loading=!1,this.students=t.students,this.dates=t.dates},setSort(t){t===this.sortKey&&(this.sortDir="asc"===this.sortDir?"desc":"asc"),this.sortKey=t},setHouse(){this.house=this.$store.state.user.globalHouse,this.house&&(this.$q.loading.show(),l["a"].getHouseStudents(this.process,this.$errorHandler,this.house.id))}},computed:{visible(){var t=this.search,e=[];return e="alert_today"===this.filterModel?this.students.filter(t=>{var e=this.dates[0].date,s=t.answers.find(t=>t.date===e);if(s)return 0===s.isHealthy&&1===s.hasAnswered}):"alert_any"===this.filterModel?this.students.filter(t=>{if(t.answers[0])return t.answers.find(t=>0===t.isHealthy&&1===t.hasAnswered)}):this.students,""===t?e:e.filter(e=>e.firstname.toLowerCase().indexOf(t)>-1||e.lastname.toLowerCase().indexOf(t)>-1||e.prename.toLowerCase().indexOf(t)>-1||e.boardingHouse.toLowerCase().indexOf(t)>-1||e.NCYear.toString().toLowerCase().indexOf(t)>-1)},sorted(){var t=this.visible.filter(t=>t.id>0);return t.sort(this.$compare(this.sortKey,this.sortDir))}},components:{Answer:o["a"]},created(){this.houseWatch=this.$store.watch(()=>this.$store.getters["user/getGlobalHouse"],this.setHouse),this.setHouse()},beforeDestroy(){this.houseWatch()}},n=i,d=s("2be6"),c=s("8c42"),h=s("6dd6"),u=s("bc74"),f=s("26a8"),p=s("2e0b"),b=s("e279"),m=s.n(b),C=Object(d["a"])(n,a,r,!1,null,"43001218",null);e["default"]=C.exports;m()(C,"components",{QPage:c["a"],QBtnToggle:h["a"],QInput:u["a"],QScrollArea:f["a"],QMarkupTable:p["a"]})}}]);