(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["e560b62a"],{"05ea":function(e,t,s){"use strict";var i=s("c6a3"),n=s.n(i);n.a},"0fb5":function(e,t,s){},"1b48":function(e,t,s){},"1ebb":function(e,t,s){"use strict";var i=s("a2b8"),n=s.n(i);n.a},"3bfd":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("toolbar-page",{attrs:{elements:e.elements,default:"sessions"}})},n=[],a=s("08e9"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"q-ma-md"},[s("crud",{ref:"crud",attrs:{data:e.data,api:e.api,columns:e.columns,actions:e.actions,rowKey:"id",search:"",canNew:"",canDelete:"",canEdit:"",inlineEdit:"",indicator:"isActive",channel:"transport.sessions",reverse:""},on:{update:function(t){return e.$emit("update")},activate:e.activate,change:function(t){return e.$emit("update")},new:e.setRoutes,routes:e.setRoutes}}),s("q-dialog",{attrs:{persistent:"",maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[s("q-card",{staticClass:"bg-dark text-white"},[s("q-bar",{staticClass:"bg-toolbar"},[e._v("\n        Copy Routes\n        "),s("q-space"),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[s("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("Close")])],1)],1),s("q-card-section",[s("set-routes",{attrs:{activeSession:e.activeSession},on:{hide:function(t){e.dialog=!1}}})],1)],1)],1)],1)},c=[],l=s("d612"),r=s("9d37"),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("span",{staticClass:"text-lime-13 text-bold"},[e._v(e._s(e.currentSession.description))]),e.currentSessionRoutes.length>0?s("div",[s("span",{staticClass:"full-width text-h4 text-center"},[e._v("This session already has routes. Delete all routes to re-enable the copying feature.")]),s("critical-button",{staticClass:"q-mt-md full-width",attrs:{label:"Close",success:function(){e.$emit("hide")}}})],1):e._e(),0===e.currentSessionRoutes.length?s("div",[s("div",{staticClass:"row"},[s("q-select",{staticClass:"q-mb-lg text-lime13",staticStyle:{width:"300px"},attrs:{label:"Copy Coaches From",options:e.options,dark:"","content-class":"text-lime13"},model:{value:e.selectedSession,callback:function(t){e.selectedSession=t},expression:"selectedSession"}}),s("div",{staticClass:"q-py-md q-ml-md col"},[s("critical-button",{staticClass:"full-width",attrs:{label:"SAVE",success:e.copyRoutes}})],1)],1),s("div",{staticClass:"row"},[s("routes",{staticClass:"col",attrs:{locked:"",session:e.selectedSessionId}})],1)]):e._e()])},d=[],p=(s("ce9c"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row"},[s("div",{staticClass:"col-4 text-left q-mx-xs",staticStyle:{border:"1px solid grey"}},[s("q-tabs",{staticClass:"bg-toolbar text-primary no-shadow",attrs:{dense:"",align:"left",breakpoint:0},model:{value:e.direction,callback:function(t){e.direction=t},expression:"direction"}},[s("q-tab",{attrs:{name:"outbound",label:"outbound",icon:"fal fa-arrow-square-right"}}),s("q-tab",{attrs:{name:"return",label:"return",icon:"fal fa-arrow-square-left"}})],1),s("div",{staticClass:"q-pa-md text-white"},[s("q-list",{attrs:{dark:"",bordered:"",separator:"",stylex:"max-width: 318px"}},e._l(e.activeRoutes,(function(t){return s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.id,class:e.selectedRoute.id===t.id?"bg-toolbar highlight":"",attrs:{clickable:"","expand-separator":"",iconx:"perm_identity",label:t.name},on:{click:function(s){return e.selectRoute(t)}}},[s("q-item-section",[s("span",[e._v("\n              "+e._s(t.name)+"\n              ")])]),s("q-item-section",{staticClass:"row",attrs:{side:""}},[s("span",[e.locked?e._e():s("edit-button",{attrs:{model:t,field:"name",success:e.saveRoute}}),e.locked?e._e():s("delete-button",{attrs:{model:t,success:e.deleteRoute,label:"Delete Route?"}})],1)])],1)})),1),e.locked?e._e():s("new-button",{staticClass:"q-mt-md",attrs:{success:e.submitNew,label:"New Route Name"}})],1)],1),s("div",{staticClass:"col text-left q-mx-xs bg-dark",staticStyle:{border:"1px solid grey"}},[s("q-bar",{staticClass:"text-primary bg-toolbar"},[e._v(e._s(e.selectedRoute.name))]),e.selectedRoute.id?s("q-card",{staticClass:"no-shadow"},[s("q-card-section",{staticClass:"row bg-dark"},[s("div",{staticClass:"col ",staticStyle:{"border-right":"1px solid grey"}},[s("q-bar",{staticClass:"text-grey text-bold",staticStyle:{background:"none"}},[e._v("Route")]),s("q-timeline",{attrs:{layoutx:"dense",side:"right",color:"primary"}},e._l(e.selectedRoute.stops,(function(t){return s("q-timeline-entry",{key:t.id,attrs:{title:t.name,subtitle:t.time,side:"left"}},[s("span",{staticClass:"no-shadow",staticStyle:{"margin-top":"-30px"}},[e.locked?e._e():s("edit-button",{attrs:{model:t,field:"name",success:e.saveStop}}),e.locked?e._e():s("edit-button",{attrs:{model:t,type:"time",field:"time",icon:"fal fa-clock",success:e.saveStop}}),e.locked?e._e():s("delete-button",{attrs:{model:t,success:e.deleteStop,label:"Delete Stop?"}})],1)])})),1),e.locked?e._e():s("new-button",{attrs:{label:"New stop name",success:e.newStop}})],1),s("div",{staticClass:"col"},[s("q-bar",{staticClass:"text-grey text-bold",staticStyle:{background:"none"}},[e._v("Coaches")]),s("q-list",{attrs:{bordered:""}},e._l(e.selectedRoute.coaches,(function(t){return s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.id},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"primary",name:"fal fa-bus"}})],1),s("q-item-section",{staticClass:"text-grey row"},[e._v("\n                "+e._s(t.capacity)+" seats\n              ")]),s("q-item-section",{staticClass:"row",attrs:{side:""}},[s("span",[e.locked?e._e():s("edit-button",{attrs:{model:t,type:"number",field:"capacity",icon:"fal fa-users",success:e.saveCoach}}),e.locked?e._e():s("delete-button",{attrs:{model:t,success:e.deleteCoach,label:"Delete Coach?"}})],1)])],1)})),1),e.locked?e._e():s("new-button",{staticClass:"q-mt-md q-ml-md",attrs:{success:e.newCoach,label:"New Coach Capacity?"}})],1)])],1):e._e()],1)])}),f=[],h=(s("e125"),s("4823"),s("2e73"),s("dde3"),s("76d0"),s("0c1f"),s("8e9e")),m=s.n(h),b=s("9ce4"),g=s("5228"),v=s("e664"),R=s("ad81"),S=s("2ccb");function y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function w(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?y(s,!0).forEach((function(t){m()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):y(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var C={name:"Tbs.Coaches.Setup",props:{session:{type:Number,default:0},locked:{type:Boolean,default:!1}},data:function(){return{direction:"outbound",routes:[],selectedRouteId:null,selectedRoute:{id:null,name:null},newName:""}},methods:{getRoutes:function(){g["a"].getRoutes(this.processRoutes,null,this.session)},saveRoute:function(e){g["a"].putRoute(this.getRoutes,null,e)},deleteRoute:function(e){g["a"].deleteRoute(this.getRoutes,null,e.id)},setSession:function(){},processRoutes:function(e){this.routes=e},selectRoute:function(e){e.id!==this.selectedRouteId&&(this.selectedRoute=e,this.selectedRouteId=e.id)},submitNew:function(e){var t=this;this.$q.loading.show();var s={name:e,sessionId:this.session,isReturn:this.isReturn};g["a"].postRoute((function(e){t.selectedRoute=e,t.selectedRouteId=e.id,t.getRoutes(),t.$q.loading.hide()}),null,s)},newStop:function(e){g["a"].postStop(this.getRoute,null,{routeId:this.selectedRouteId,name:e})},saveStop:function(e){g["a"].putStop(this.getRoute,null,e)},deleteStop:function(e){g["a"].deleteStop(this.getRoute,null,e.id)},getRoute:function(){var e=this,t=this.selectedRouteId;g["a"].getRoute((function(t){e.selectedRoute=t}),null,t)},newCoach:function(e){g["a"].postCoach(this.getRoute,null,{routeId:this.selectedRouteId,capacity:e})},saveCoach:function(e){g["a"].putCoach(this.getRoute,null,e)},deleteCoach:function(e){g["a"].deleteCoach(this.getRoute,null,e.id)}},watch:{selectedRouteId:function(){this.getRoute()},session:function(){this.getRoutes()}},computed:w({},Object(b["c"])("transport",["activeSession"]),{isReturn:function(){return"outbound"===this.direction?1:0},activeRoutes:function(){var e=this,t=this.routes.filter((function(t){return t.isReturn===e.isReturn}));return t}}),components:{DeleteButton:v["a"],NewButton:R["a"],EditButton:S["a"]},created:function(){var e=this;this.session>0&&this.$store.watch((function(){return e.$store.getters["transport/activeSession"]}),this.setSession),this.getRoutes()}},q=C,x=(s("1ebb"),s("2be6")),_=Object(x["a"])(q,p,f,!1,null,"44bd24e4",null),O=_.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-btn",{staticClass:"col q-ma-sm",attrs:{size:e.size,outline:"",color:"lime-13",dense:"",icon:e.icon,label:e.label},on:{click:function(t){return e.success()}}})},D=[],$={name:"Component.Buttons.critical",props:{success:{type:Function,required:!0},size:{type:String,default:"md"},icon:{type:String,default:""},label:{type:String,default:"Delete"}},data:function(){return{}},methods:{},computed:{},components:{},created:function(){}},j=$,E=(s("7eb2"),Object(x["a"])(j,k,D,!1,null,"a68c24c2",null)),I=E.exports,N={name:"Tbs.Coaches.Routes",props:{activeSession:{required:!0,type:Number}},data:function(){return{sessions:[],deployedSession:null,selectedSession:null,selectedSessionId:null,currentSessionRoutes:[],currentSession:[]}},methods:{setOptions:function(e){this.sessions=e,this.sessions.unshift({id:0,description:"DEFAULT ROUTES"})},getGlobalOptions:function(){r["a"].getSessions(this.setOptions)},copyRoutes:function(){this.$q.loading.show(),g["a"].postCopyRoutes(this.copied,null,this.selectedSession.id,this.activeSession)},copied:function(){this.$q.loading.hide(),this.$emit("hide")}},watch:{selectedSession:function(){this.selectedSessionId=this.selectedSession.value}},computed:{options:function(){return this.sessions.map((function(e){return{value:e.id,label:e.description,sublabel:1===e.isActive?"ACTIVE":""}}))}},components:{Routes:O,CriticalButton:I},created:function(){var e=this;this.getGlobalOptions(),this.selectedSession={value:0,label:"DEFAULT ROUTES"},this.selectedSession.id=0,g["a"].getRoutes((function(t){e.currentSessionRoutes=t}),null,this.activeSession),r["a"].getSession((function(t){e.currentSession=t,console.log(e.currentSession)}),null,this.activeSession)}},T=N,P=(s("a62b"),Object(x["a"])(T,u,d,!1,null,"35aeda0d",null)),A=P.exports,B=s("89a2"),F={name:"ComponentCompanies",data:function(){return{dialog:!1,activeSession:null,api:{get:r["a"].getSessions,getSingle:r["a"].getSession,put:r["a"].putSession,post:r["a"].postSession,delete:r["a"].deleteSession},columns:[{name:"id",label:"id",field:"id",type:"string",align:"left",hidden:!0},{name:"description",label:"Description",field:"description",type:"string",align:"left",validations:{required:B["required"],minLength:Object(B["minLength"])(4)},editable:!0},{name:"dteOutward",label:"Outward Date",field:"dateOut",type:"date",align:"right",validations:{},editable:!0},{name:"dteRet",label:"Ret Date",field:"dateRtn",type:"date",align:"right",validations:{},editable:!0},{name:"taxiOutDeadlineDateTime",label:"Taxi Out Deadline",field:"taxiOutDeadline",type:"datetime",align:"right",validations:{},editable:!0},{name:"coachOutDeadline",label:"Coach Out Deadline",field:"coachOutDeadline",type:"datetime",align:"right",validations:{},editable:!0},{name:"taxiRetDeadline",label:"Txi Rtn Deadline",field:"taxiRetDeadline",type:"datetime",align:"right",validations:{},editable:!0},{name:"coachRetDeadline",label:"Coach Rtn Deadline",field:"coachRetDeadline",type:"datetime",align:"right",validations:{},editable:!0}],actions:[{title:"Make Active",event:"activate",icon:"fal fa-check",confirm:!0,confirmMessage:"Are you sure?"},{title:"Copy Routes",event:"routes",icon:"fal fa-bus"}],showForm:!0,maxWidth:800}},methods:{setRoutes:function(e){this.activeSession=e.id?e.id:e,this.dialog=!0},activate:function(e){var t=this;r["a"].activateSession((function(){t.update()}),(function(){console.warn("Unable to Activate")}),e["id"])},update:function(){this.$refs.crud.get(),this.$emit("update")}},computed:{},components:{Crud:l["a"],SetRoutes:A},created:function(){}},U=F,z=(s("05ea"),Object(x["a"])(U,o,c,!1,null,"5d38231a",null)),L=z.exports,G={name:"Page.TBS.Settings",data:function(){return{elements:[{name:"sessions",label:"sessions",component:L,shortcut:"b"},{name:"routes",label:"default routes",shortcut:"a",component:O}]}},components:{toolbarPage:a["a"]}},J=G,M=Object(x["a"])(J,i,n,!1,null,null,null);t["default"]=M.exports},"7eb2":function(e,t,s){"use strict";var i=s("1b48"),n=s.n(i);n.a},"9d37":function(e,t,s){"use strict";var i=s("4778");t["a"]={getSessions:function(e,t){i["a"].get("/transport/sessions").then((function(t){e(t.data)})).catch((function(e){e()}))},getSession:function(e,t,s){i["a"].get("/transport/sessions/"+s).then((function(t){e(t.data)})).catch((function(e){e()}))},activateSession:function(e,t,s){i["a"].post("/transport/sessions/activate/"+s).then((function(t){e(t.data)})).catch((function(e){e()}))},deleteSession:function(e,t,s){i["a"].delete("/transport/sessions/"+s).then((function(t){e(t.data)})).catch((function(e){e()}))},putSession:function(e,t,s){i["a"].put("/transport/sessions",s).then((function(t){e(t.data)})).catch((function(e){e()}))},postSession:function(e,t,s){i["a"].post("/transport/sessions",s).then((function(t){e(t.data)})).catch((function(e){e()}))}}},a2b8:function(e,t,s){},a62b:function(e,t,s){"use strict";var i=s("0fb5"),n=s.n(i);n.a},c6a3:function(e,t,s){}}]);