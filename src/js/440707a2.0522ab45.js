(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["440707a2"],{"48b1":function(t,e,n){"use strict";var o=n("9882"),s=n.n(o);s.a},"5e32":function(t,e,n){n("36f8")("asyncIterator")},"69f2":function(t,e,n){},"6c36":function(t,e,n){"use strict";var o=n("8065"),s=n.n(o);s.a},"6fa1":function(t,e,n){},8065:function(t,e,n){},"829b":function(t,e,n){},"8ab1":function(t,e,n){"use strict";var o=n("69f2"),s=n.n(o);s.a},"8b05":function(t,e,n){"use strict";var o=n("4778");e["a"]={getNames:function(t,e){o["a"].get("/students/names").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getDetails:function(t,e,n){o["a"].get("/students/details/"+n.id).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getTags:function(t,e){o["a"].get("/students/tags").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}}},9550:function(t,e,n){"use strict";var o=n("829b"),s=n.n(o);s.a},9882:function(t,e,n){},a0ad:function(t,e,n){"use strict";var o=n("4778"),s=n("452d");e["a"]={getAllBookings:function(t,e,n){var a=s["a"].getters["transport/activeSession"];o["a"].get("/transport/taxis/bookings/"+a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getBookings:function(t,e,n){var a=s["a"].getters["transport/activeSession"];o["a"].get("/transport/taxis/bookings/"+a+"/"+n.type).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getNewCount:function(t,e){var n=s["a"].getters["transport/activeSession"];o["a"].get("/transport/taxis/newbookings/"+n).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getBookingsByCompany:function(t,e,n){var a=s["a"].getters["transport/activeSession"];o["a"].get("/transport/taxis/companies/bookings/"+a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getBooking:function(t,e,n){var a=s["a"].getters["transport/activeSession"];o["a"].get("/transport/taxis/bookings/"+a+"/"+n.id).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},putBooking:function(t,e,n){o["a"].put("/transport/taxis/bookings",n).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},putTaxiAssignment:function(t,e,n){o["a"].put("/transport/taxis/assignment",n).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},putConfirmBooking:function(t,e,n){o["a"].put("/transport/taxis/confirm",n).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},postBooking:function(t,e,n){o["a"].post("/transport/taxis/bookings",n).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},deleteBooking:function(t,e,n){o["a"].delete("/transport/taxis/bookings/"+n).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getSummary:function(t,e,n){var a=s["a"].getters["transport/activeSession"];o["a"].get("/transport/taxis/summary/"+a+"/"+n).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},postSummary:function(t,e,n){o["a"].post("/transport/taxis/summary",n).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))}}},ae23:function(t,e,n){"use strict";var o=n("6fa1"),s=n.n(o);s.a},c0f5:function(t,e,n){"use strict";var o=n("4778");e["a"]={getStudentNames:function(t,e){o["a"].get("/students/names").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getStudentList:function(t,e){o["a"].get("/students/list").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}}},e1b0:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("toolbar-page",{attrs:{elements:t.elements,default:"bookings"}})},s=[],a=n("08e9"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"q-ma-md block full-height"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col",staticStyle:{"border-right":"1px solid #293557"}},[n("crud",{ref:"crud",attrs:{columns:t.columns,api:t.api,search:"",filter:"",canDelete:"",canNew:"",canEdit:"",inlineEdit:"",newComponent:t.newComponent}})],1),n("div",{staticClass:"col-5 full-height no-border"},[n("q-tabs",{staticClass:"narrow shadow-1 full-height no-border no-shadow",attrs:{animated:"",swipeable:"",align:"justify","underline-color":"primary"}},[n("q-tab",{attrs:{slot:"title",default:"",name:"cancel",iconx:"fas fa-ban",label:"Cancelled"},slot:"title"}),n("q-tab",{attrs:{slot:"title",name:"coaches",iconx:"fas fa-bus",label:"Coaches"},slot:"title"}),n("q-tab",{attrs:{slot:"title",name:"accounts",iconx:"far fa-file-excel",label:"Accounts"},slot:"title"})],1)],1)])])},r=[],l=(n("e125"),n("4823"),n("2e73"),n("dde3"),n("76d0"),n("0c1f"),n("c880"),n("288e"),n("8e9e")),c=n.n(l),u=n("d612"),d=n("4778"),p={getBookings:function(t,e,n){d["a"].get("/transport/coaches/bookings/"+n.sessionID).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getCoaches:function(t,e,n){d["a"].get("/transport/coaches").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},cancelBookings:function(t,e,n){d["a"].post("/transport/coaches/bookings/cancel",t).then((function(t){e(t.data)})).catch((function(t){console.log(t),n()}))},changeBusOut:function(t,e,n){var o={};o.id=t,o.txtBusOut=e,d["a"].put("/transport/coaches/bookings/changebusout",o).then((function(t){n()})).catch((function(t){console.log(t)}))},changeBusReturn:function(t,e,n){var o={};o.id=t,o.txtBusRet=e,d["a"].put("/transport/coaches/bookings/changebusreturn",o).then((function(t){n()})).catch((function(t){console.log(t)}))},getBusSummaries:function(t,e,n){d["a"].get("/transport/coaches/bookings/bussummaries/"+t).then((function(t){e(t.data)})).catch((function(t){console.log(t)}))}},f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-table",{staticClass:"full-height no-border no-shadow",staticStyle:{"min-widthx":"800px","min-height":"710px"},attrs:{data:t.busSummaries,columns:t.columns,separator:t.separator,"row-key":t.code,pagination:t.paginationControl,color:"primary","hide-header":"",dark:t.isDark,dense:""},on:{"update:pagination":function(e){t.paginationControl=e}},scopedSlots:t._u([{key:"top-right",fn:function(e){return[n("q-btn",{staticClass:"q-mr-lg",attrs:{color:0===t.filterOut.length&&0===t.filterRet.length?"dark":"primary",label:"Clear Filters",disabled:0===t.filterOut.length&&0===t.filterRet.length,icon:"visibility",size:"xs"},on:{click:t.clearFilters}})]}},{key:"body",fn:function(e){return[n("q-tr",{attrs:{props:e}},[n("q-td",{key:"id",attrs:{props:e}},[n("q-checkbox",{staticClass:"q-mr-md",attrs:{color:"primary","checked-icon":"remove","unchecked-icon":"add"},model:{value:e.expand,callback:function(n){t.$set(e,"expand",n)},expression:"props.expand"}}),t._v("\n      "+t._s(e.row.id)+"\n    ")],1),n("q-td",{key:"code",attrs:{props:e}},[t._v(t._s(e.row.txtBusCode))]),n("q-td",{key:"destination",attrs:{props:e}},[t._v(t._s(e.row.txtDestination))]),n("q-td",{key:"countOut",staticClass:"text-justify",attrs:{props:e}},[n("q-checkbox",{staticClass:"q-mr-sm q-ml-xs",attrs:{dark:"",disable:0==e.row.countOut,val:e.row.txtBusCode,"checked-icon":"visibility","unchecked-icon":"visibility"},on:{input:t.setCoachOutFilter},model:{value:t.filterOut,callback:function(e){t.filterOut=e},expression:"filterOut"}}),t._v("\n      "+t._s(e.row.countOut)+"\n    ")],1),n("q-td",{key:"countRet",staticClass:"text-justify",attrs:{props:e}},[n("q-checkbox",{staticClass:"q-mr-sm q-ml-xs",attrs:{dark:"",disable:0==e.row.countRet,val:e.row.txtBusCode,"checked-icon":"visibility","unchecked-icon":"visibility"},on:{input:t.setCoachRetFilter},model:{value:t.filterRet,callback:function(e){t.filterRet=e},expression:"filterRet"}}),t._v("\n      "+t._s(e.row.countRet)+"\n    ")],1)],1),n("q-tr",{directives:[{name:"show",rawName:"v-show",value:e.expand,expression:"props.expand"}],attrs:{props:e}},[n("q-td",{attrs:{colspan:"100%"}},[n("div",{staticClass:"text-left"},[n("q-tabs",{attrs:{color:"#191919","underline-color":"primary"}},[n("q-tab",{attrs:{slot:"title",default:"",name:"details",label:"Details"},slot:"title"}),n("q-tab",{attrs:{slot:"title",name:"out",label:"Out"},slot:"title"}),n("q-tab",{attrs:{slot:"title",name:"ret",label:"Ret"},slot:"title"}),n("q-tab-panel",{attrs:{name:"details"}},[t._v("Tab One")]),n("q-tab-panel",{attrs:{name:"out"}},[t._v("Tab Two")]),n("q-tab-panel",{attrs:{name:"ret"}},[t._v("Tab Three")])],1)],1)])],1)]}}])})},b=[],h=n("9ce4");function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(n,!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"ComponentTransportCoachesDetails",props:{busSummaries:{type:Array}},data:function(){return{columns:[{name:"id",label:"#",field:"id",align:"left"},{name:"code",label:"Code",field:"txtBusCode"},{name:"destination",label:"Destination",field:"txtDestination"},{name:"countOut",label:"Bookings Out",field:"countOut"},{name:"countRet",label:"Bookings Ret",field:"countRet"}],paginationControl:{rowsPerPage:40,page:1,sortBy:"txtBusCode"},separator:"horizontal",filterOut:[],filterRet:[]}},methods:g({},Object(h["d"])("transport",["setCoachOutFilter","setCoachRetFilter"]),{clearFilters:function(){this.filterRet=[],this.filterOut=[],this.setCoachOutFilter([]),this.setCoachRetFilter([])}}),computed:g({},Object(h["c"])("transport",["coachOutFilter","coachRetFilter"]),{},Object(h["e"])("users",["isDark"])),components:{},created:function(){},watch:{busSummaries:function(){console.log(this.busSummaries)}}},k=v,y=(n("9550"),n("2be6")),O=Object(y["a"])(k,f,b,!1,null,"5eb6594c",null),w=O.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"block full-height",staticStyle:{"min-width":"400px"}},[n("q-select",{staticClass:"q-ml-sm",attrs:{filter:"",options:t.names,"stack-label":"Select Student",dark:""},model:{value:t.selectedStudent,callback:function(e){t.selectedStudent=e},expression:"selectedStudent"}}),n("h5",[t._v("Outward Journey")]),n("div",{staticClass:"row"},[n("q-select",{staticClass:"q-ml-sm col-6",attrs:{filter:"",options:t.names,"stack-label":"Pickup Location",dark:""},model:{value:t.selectedStudent,callback:function(e){t.selectedStudent=e},expression:"selectedStudent"}}),n("q-date",{staticStyle:{"margin-left":"5px"},attrs:{color:"grey",type:"time",format24h:"","float-label":"Pickup Time",dark:""},model:{value:t.date2,callback:function(e){t.date2=e},expression:"date2"}})],1),n("p",{staticClass:"caption text-grey q-mt-sm"},[t._v("Destination")]),n("div",{staticClass:"row"},[n("q-radio",{staticClass:"dark col-4",staticStyle:{color:"grey"},attrs:{dark:"true",val:"flight",label:"flight"},model:{value:t.destination,callback:function(e){t.destination=e},expression:"destination"}}),n("q-radio",{staticClass:"dark col-4",staticStyle:{color:"grey","margin-left":"0px"},attrs:{val:"train",label:"train"},model:{value:t.destination,callback:function(e){t.destination=e},expression:"destination"}}),n("q-radio",{staticClass:"dark col-4",staticStyle:{color:"grey","margin-left":"0px"},attrs:{val:"other",label:"other"},model:{value:t.destination,callback:function(e){t.destination=e},expression:"destination"}})],1),n("div",{staticClass:"q-mt-sm"},["flight"===t.destination?n("div",[n("q-select",{staticClass:"q-ml-sm",attrs:{filter:"",options:t.names,"stack-label":"Airport",dark:""},model:{value:t.selectedStudent,callback:function(e){t.selectedStudent=e},expression:"selectedStudent"}}),n("q-input",{attrs:{"stack-label":"Flight Number",placeholder:"",dark:""},model:{value:t.flightNumber,callback:function(e){t.flightNumber=e},expression:"flightNumber"}})],1):t._e(),"train"===t.destination?n("div",[n("q-select",{staticClass:"q-ml-sm",attrs:{filter:"",options:t.names,"stack-label":"Station",dark:""},model:{value:t.selectedStudent,callback:function(e){t.selectedStudent=e},expression:"selectedStudent"}}),n("q-date",{staticStyle:{"margin-left":"5px"},attrs:{color:"grey",type:"time",format24h:"","float-label":"Train Time",dark:""},model:{value:t.date2,callback:function(e){t.date2=e},expression:"date2"}})],1):t._e()])],1)},C=[],S=n("a0ad"),q=n("c0f5");function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(n,!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={data:function(){return{selectedStudent:null,pickupLocation:null,names:[],destination:"",flightNumber:""}},methods:{setSession:function(){var t=this.activeSession;this.loading=!0,S["a"].getSessionDetails(t,this.loadSession)},loadSession:function(t){this.loading=!1}},computed:j({},Object(h["c"])("transport",["activeSession"])),components:{},mounted:function(){var t=this;this.$store.watch((function(){return t.$store.getters["transport/activeSession"]}),this.setSession),this.setSession()},created:function(){var t=this;q["a"].getStudentNames((function(e){t.names=e}))}},B=_,P=Object(y["a"])(B,x,C,!1,null,null,null),D=P.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-table",{staticClass:"full-height no-border no-shadow",staticStyle:{"min-widthx":"800px","min-height":"710px"},attrs:{data:t.bookingsCancelled,columns:t.columns,filter:t.filter,separator:t.separator,pagination:t.paginationControl,"row-key":t.id,selection:"multiple",selected:t.selectedRows,color:"primary","hide-header":"",dark:t.isDark,dense:""},on:{"update:pagination":function(e){t.paginationControl=e},"update:selected":function(e){t.selectedRows=e}},scopedSlots:t._u([{key:"top-left",fn:function(e){return[n("q-input",{staticClass:"col-6",attrs:{type:"search","hide-underline":"",color:"secondary",dark:t.isDark},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]}},{key:"top-selection",fn:function(t){}},{key:"top-right",fn:function(e){return[n("q-table-columns",{staticClass:"q-mr-sm text-white",staticStyle:{color:"white"},attrs:{color:"white",dark:t.isDark,columns:t.columns},model:{value:t.visibleColumns,callback:function(e){t.visibleColumns=e},expression:"visibleColumns"}}),n("q-btn",{staticClass:"q-mr-xs",attrs:{color:"green",label:"cancel",round:"",icon:"add",size:"xs"},on:{click:t.cancel}})]}}])})},E=[];function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(n,!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var F={name:"ComponentTransportCoachesCancelled",props:{bookingsCancelled:{type:Array}},data:function(){return{paginationControl:{rowsPerPage:40,page:1,sortBy:"txtBusCode"},separator:"horizontal",columns:[{name:"lastName",required:!0,label:"Name",align:"left",field:"lastName",sortable:!0},{name:"firstName",required:!0,label:"",align:"left",field:"firstName",sortable:!0},{name:"gender",label:"M/F",field:"gender",sortable:!0},{name:"house",label:"Hs",field:"boarding",sortable:!0},{name:"busOut",label:"Bus Out",field:"txtBusOut",sortable:!0},{name:"busRet",label:"Bus Return",field:"txtBusRet",sortable:!0,align:"center"}]}},methods:{},computed:$({},Object(h["e"])("user",["isDark"])),components:{},created:function(){}},I=F,A=(n("8ab1"),Object(y["a"])(I,N,E,!1,null,"6d77083c",null)),z=A.exports;function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(n,!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var J={name:"PageTransportExplorer",data:function(){return{newComponent:D,api:{get:p.getBookings,parameters:{sessionID:0},put:p.getBookings},coaches:[],coachesSelect:[],bookingsAll:[],filter:"",loading:!1,separator:"horizontal",busSummaries:[],pagination:{page:1},paginationControl:{rowsPerPage:40,page:1,sortBy:"lastName"},dark:!0,columns:[{name:"id",label:"id",field:"id",type:"string",align:"left",hidden:!0},{name:"lastName",required:!0,label:"Name",align:"left",field:"lastName",sortable:!0},{name:"firstName",required:!0,label:"",align:"left",field:"firstName",sortable:!0},{name:"gender",label:"M/F",field:"gender",sortable:!0,align:"left"},{name:"house",label:"Hs",field:"boarding",sortable:!0,align:"left"},{name:"busOut",label:"Bus Out",field:"txtBusOut",sortable:!0,type:"options",options:[],editable:!0,filter:!0},{name:"busRet",label:"Bus Return",field:"txtBusRet",sortable:!0,type:"options",options:[],editable:!0,filter:!0}],filterCoachOut:"",newModalOpen:!1}},computed:H({},Object(h["c"])("transport",["activeSession","coachOutFilter","coachRetFilter"]),{},Object(h["e"])("user",["isDark"]),{bookings:function(){var t=this,e=this.bookingsAll.filter((function(t,e){return"0"===t.boolCancelled}));return 0===this.coachOutFilter.length&&0===this.coachRetFilter.length?e:e.filter((function(e,n){return t.coachOutFilter.find((function(t){return t===e.txtBusOut}))||t.coachRetFilter.find((function(t){return t===e.txtBusRet}))}))},bookingsCancelled:function(){var t=this.bookingsAll.filter((function(t,e){return"1"===t.boolCancelled}));return t}}),methods:H({},Object(h["d"])("transport",["setCoachOutFilter","setCoachRetFilter"]),{setSession:function(){this.api.parameters.sessionID=this.activeSession,this.$refs.crud.get(),this.loading=!0},setOptions:function(){var t=this;p.getCoaches((function(e){var n=e.map((function(t){return{label:t.txtBusCode,value:t.txtBusCode}}));t.columns.find((function(t){return"busOut"===t.name})).options=n,t.columns.find((function(t){return"busRet"===t.name})).options=n,console.log(t.columns)}))},loadSession:function(t){this.bookingsAll=t.bookings,this.coaches=t.coaches,this.coachesSelect=t.coachesSelect,this.loading=!1},loadBusSummaries:function(t){this.busSummaries=t},cancel:function(t){var e=this,n=this.selectedRows.length;0!==n&&this.$q.dialog({title:"Confirm",message:"Cancel ".concat(n," Bookings "),ok:"Agree",cancel:"Disagree"}).then((function(){e.loading=!0,p.cancelBookings(e.selectedRows,e.cancelComplete,e.cancelError)})).catch((function(){}))},cancelComplete:function(t){var e=t.length,n=this.bookingsAll;t.forEach((function(t,e){var o=n.find((function(e){return e.id===t.id}));o&&(o.boolCancelled="1")})),this.selectedRows=[],this.$q.notify("".concat(e," Bookings Cancelled")),this.loading=!1,this.busSummariesShow()},cancelError:function(){this.$q.notify("Something Went Wrong")},changeBusOut:function(t,e){p.changeBusOut(t,e,this.busSummariesShow)},changeBusRet:function(t,e){p.changeBusReturn(t,e,this.busSummariesShow)},busSummariesShow:function(){if(this.bookings.length>0)return p.getBusSummaries(this.activeSession,this.loadBusSummaries),!0}}),watch:{},components:{coachDetails:w,cancelled:z,newBooking:D,Crud:u["a"]},mounted:function(){var t=this;this.api.parameters={sessionID:this.activeSession},this.setCoachOutFilter([]),this.setCoachRetFilter([]),this.$store.watch((function(){return t.$store.getters["transport/activeSession"]}),this.setSession),this.setSession(),this.setOptions()},created:function(){console.log("here",this.$store.getters["transport/activeSession"])}},M=J,W=Object(y["a"])(M,i,r,!1,null,null,null),G=W.exports,K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"full-width",attrs:{stylex:"text-align:center; position: relative"}},[n("q-dialog",{ref:"new",attrs:{"content-classes":"new-modal bg-dark q-pa-md",persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.showForm,callback:function(e){t.showForm=e},expression:"showForm"}},[n("q-card",{staticClass:"bg-grey-9",attrs:{dark:""}},[n("q-toolbar",[n("q-toolbar-title",[t._v("New Booking")]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),n("q-card-section",[n("booking",{attrs:{channel:"tbs.taxi.bookings"},on:{close:t.close,saved:t.close}})],1)],1)],1)],1)},Q=[],U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col",staticStyle:{"min-width":"500px","min-height":"50vh"}},[n("div",{staticClass:"col-12"},[n("q-select",{ref:"name",attrs:{"map-options":"",dense:"",autofocus:"",clearable:"",outlined:"",options:t.pupilOptions,label:"Pupil Name","content-class":"bg-dark",dark:"",error:t.$v.booking.pupilId.$error,"use-input":"","input-debounce":"0",readonly:t.isEdit},on:{change:function(e){return t.pupilDetails(t.selectedPupil)},input:function(e){return t.pupilDetails(t.selectedPupil)},filter:t.pupilFilter},model:{value:t.selectedPupil,callback:function(e){t.selectedPupil=e},expression:"selectedPupil"}}),t.pupilHouse?n("q-chip",{attrs:{dense:"",icon:"home",size:"10px"}},[t._v(t._s(t.pupilHouse))]):t._e(),t.pupilEmail?n("q-chip",{attrs:{dense:"",icon:"mail",size:"10px"}},[t._v(t._s(t.pupilEmail))]):t._e()],1),n("br"),n("q-tabs",{staticClass:"bg-grey-8 text-primary",attrs:{dense:""},model:{value:t.journeyTab,callback:function(e){t.journeyTab=e},expression:"journeyTab"}},[t.isRetOnly?t._e():n("q-tab",{attrs:{name:"out",label:"Outbound"}}),t.isOutOnly?t._e():n("q-tab",{attrs:{name:"ret",label:"Return"}})],1),n("q-tab-panels",{attrs:{animated:""},model:{value:t.journeyTab,callback:function(e){t.journeyTab=e},expression:"journeyTab"}},[n("q-tab-panel",{staticClass:"bg-secondar q-px-xs",attrs:{name:"out"}},[n("q-select",{attrs:{"map-options":"",outlined:"",dense:"",clearable:"",options:t.pickupOptions,label:"From","content-class":"bg-dark",dark:"","use-input":"","emit-value":"","input-debounce":"0"},on:{filter:t.pickupFilter},model:{value:t.booking.out.stop,callback:function(e){t.$set(t.booking.out,"stop",e)},expression:"booking.out.stop"}})],1),n("q-tab-panel",{staticClass:"bg-secondar q-px-xs",attrs:{name:"ret"}},[n("h1",{staticClass:"q-mx-none q-pa-xs fullwidth bgx-grey-8"},[t._v("Pickup")]),t.booking.ret.journeyType?n("h1",{staticClass:"q-mx-none q-pa-xs fullwidth bgx-grey-8"},[t._v("Destination")]):t._e(),n("q-select",{attrs:{"map-options":"",outlined:"",dense:"",clearable:"",options:t.stops,label:"From","content-class":"bg-dark",dark:"","use-input":"","emit-value":"","input-debounce":"0"},on:{filter:t.pickupFilter},model:{value:t.booking.ret.stop,callback:function(e){t.$set(t.booking.ret,"stop",e)},expression:"booking.ret.stop"}})],1)],1),t.showBottomButtons?n("div",[n("div",{staticClass:"row q-mt-md full-width"},[n("q-btn",{staticClass:"text-primary col",attrs:{size:"large",outlinex:"",xflat:"",color:"primary","text-color":"black",dark:"",icon:"fal fa-check",label:t.isEdit?"Save Changes":"Submit Booking"},nativeOn:{click:function(e){return t.submit(e)}}})],1)]):t._e()],1)},V=[],X=(n("5e32"),n("ce9c"),n("8b05")),Y=n("5228"),Z=n("89a2"),tt={name:"TBSCoachBookingNew",props:{bookingToEdit:{type:Object},id:{type:Number},channel:{type:String,default:""}},data:function(){return{dark:!0,isOutOnly:!1,isRetOnly:!1,hasSubmitted:!1,journeyTab:"out",selectedPupil:null,pupilHouse:null,pupilEmail:null,stops:[],booking:{id:null,pupilId:null,sessionId:null,out:{stop:null},ret:{stop:null}}}},validations:function(){return{booking:{pupilId:{required:Z["required"]},out:{pickup:{}},ret:{destination:{}}}}},methods:{submit:function(){var t=this;this.hasSubmitted=!0,this.$v.booking.$touch(),this.$v.booking.$error?this.$q.notify("Please review fields again."):(this.$q.loading.show(),p.postBooking((function(){t.$q.notify("Submitted"),t.$q.loading.hide(),t.$emit("saved")}),(function(){t.$q.notify("Sad Face :("),t.$q.loading.hide()}),this.booking))},pupilDetails:function(t){var e=this;this.booking.pupilId=t.value,X["a"].getDetails((function(t){e.pupilHouse=t.boardingHouse,e.pupilEmail=t.email}),null,{id:t.value})},getStudents:function(){var t=this;X["a"].getNames((function(e){t.pupilNames=e.map((function(t){return{value:t.id,label:t.lastname+", "+t.firstname,sublabel:"Millmead"}}));var n=t.pupilNames.find((function(e){return e.value===t.bookingToEdit.studentId}));t.selectedPupil=t.bookingToEdit?n:null,t.pupilDetails(n);var o=!0,s=!1,a=void 0;try{for(var i,r=t.bookingToEdit.passengerIds[Symbol.iterator]();!(o=(i=r.next()).done);o=!0){var l=i.value;t.isOutOnly&&t.addPassengerOut({value:l}),t.isRetOnly&&t.addPassengerRet({value:l})}}catch(c){s=!0,a=c}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}}))},getStops:function(){var t=this;Y["a"].getStops((function(e){t.stop=e.map((function(t){return{value:t.id,label:t.name}}));var n=t.airports.find((function(e){return e.value===t.bookingToEdit.airportId}));t.isEdit&&t.isOutOnly&&(t.booking.out.airport=n),t.isEdit&&t.isRetOnly&&(t.booking.ret.airport=n)}))},pupilFilter:function(t,e){var n=this;e(""!==t?function(){var e=t.toLowerCase();n.pupilOptions=n.pupilNames.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))}:function(){n.pupilOptions=n.pupilNames})},pickupFilter:function(t,e){var n=this;e(""!==t?function(){var e=t.toLowerCase();n.pickupOptions=n.pickupOptions.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))}:function(){n.pickupOptions=n.pickupLocations})},mergeJourney:function(t,e){t.journeyType=e.journeyType,t.pickupTime=e.pickupTime,t.flightTime=e.flightTime,t.flightNumber=e.flightNumber,t.trainTime=e.trainTime,t.address=e.address}},computed:{showBottomButtons:function(){return this.isEdit||this.booking.out.pickup&&this.booking.out.journeyType||this.booking.ret.destination}},watch:{},components:{},created:function(){this.booking.sessionId=this.$store.getters["transport/activeSession"],this.getStops()}},et=tt,nt=(n("6c36"),Object(y["a"])(et,U,V,!1,null,"09686276",null)),ot=nt.exports,st={name:"TaxiBookingNewContainer",props:{},data:function(){return{showForm:!0}},methods:{close:function(){this.showEditForm=!1,this.$emit("close")}},computed:{},components:{Booking:ot},created:function(){}},at=st,it=(n("48b1"),Object(y["a"])(at,K,Q,!1,null,"5843c28c",null)),rt=it.exports,lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},[n("div",{staticClass:"col-4 text-left q-mx-xs",staticStyle:{border:"1px solid grey"}},[n("q-tabs",{staticClass:"bg-toolbar text-primary no-shadow",attrs:{dense:"",align:"left",breakpoint:0},model:{value:t.direction,callback:function(e){t.direction=e},expression:"direction"}},[n("q-tab",{attrs:{name:"outbound",label:"outbound",icon:"fal fa-arrow-square-right"}}),n("q-tab",{attrs:{name:"return",label:"return",icon:"fal fa-arrow-square-left"}})],1),n("div",{staticClass:"q-pa-md text-white"},[n("q-list",{attrs:{dark:"",bordered:"",separator:"",stylex:"max-width: 318px"}},t._l(t.activeRoutes,(function(e){return n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,class:t.selectedRoute.id===e.id?"bg-toolbar highlight":"",attrs:{clickable:"","expand-separator":"",iconx:"perm_identity",label:e.name},on:{click:function(n){return t.selectRoute(e)}}},[n("q-item-section",[n("span",[t._v("\n              "+t._s(e.name)+"\n              ")])]),n("q-item-section",{staticClass:"row",attrs:{side:""}},[n("span",[t.locked?t._e():n("edit-button",{attrs:{model:e,field:"name",success:t.saveRoute}}),t.locked?t._e():n("delete-button",{attrs:{model:e,success:t.deleteRoute,label:"Delete Route?"}})],1)])],1)})),1),t.locked?t._e():n("new-button",{staticClass:"q-mt-md",attrs:{success:t.submitNew,label:"New Route Name"}})],1)],1),n("div",{staticClass:"col text-left q-mx-xs bg-dark",staticStyle:{border:"1px solid grey"}},[n("q-bar",{staticClass:"text-primary bg-toolbar"},[t._v(t._s(t.selectedRoute.name))]),t.selectedRoute.id?n("q-card",{staticClass:"no-shadow"},[n("q-card-section",{staticClass:"row bg-dark"},[n("div",{staticClass:"col ",staticStyle:{"border-right":"1px solid grey"}},[n("q-bar",{staticClass:"text-grey text-bold",staticStyle:{background:"none"}},[t._v("Route")]),n("q-timeline",{attrs:{layoutx:"dense",side:"right",color:"primary"}},t._l(t.selectedRoute.stops,(function(e){return n("q-timeline-entry",{key:e.id,attrs:{title:e.name,subtitle:e.time,side:"left"}},[n("span",{staticClass:"no-shadow",staticStyle:{"margin-top":"-30px"}},[t.locked?t._e():n("edit-button",{attrs:{model:e,field:"name",success:t.saveStop}}),t.locked?t._e():n("edit-button",{attrs:{model:e,type:"time",field:"time",icon:"fal fa-clock",success:t.saveStop}}),t.locked?t._e():n("delete-button",{attrs:{model:e,success:t.deleteStop,label:"Delete Stop?"}})],1)])})),1),t.locked?t._e():n("new-button",{attrs:{label:"New stop name",success:t.newStop}})],1),n("div",{staticClass:"col"},[n("q-bar",{staticClass:"text-grey text-bold",staticStyle:{background:"none"}},[t._v("Coaches")]),n("q-list",{attrs:{bordered:""}},t._l(t.selectedRoute.coaches,(function(e){return n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{color:"primary",name:"fal fa-bus"}})],1),n("q-item-section",{staticClass:"text-grey row"},[t._v("\n                "+t._s(e.capacity)+" seats\n              ")]),n("q-item-section",{staticClass:"row",attrs:{side:""}},[n("span",[t.locked?t._e():n("edit-button",{attrs:{model:e,type:"number",field:"capacity",icon:"fal fa-users",success:t.saveCoach}}),t.locked?t._e():n("delete-button",{attrs:{model:e,success:t.deleteCoach,label:"Delete Coach?"}})],1)])],1)})),1),t.locked?t._e():n("new-button",{staticClass:"q-mt-md q-ml-md",attrs:{success:t.newCoach,label:"New Coach Capacity?"}})],1)])],1):t._e()],1)])},ct=[],ut=n("e664"),dt=n("ad81"),pt=n("2ccb");function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function bt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(n,!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ht={name:"Tbs.Coaches.Setup",props:{session:{type:Number,default:0},locked:{type:Boolean,default:!1}},data:function(){return{direction:"outbound",routes:[],selectedRouteId:null,selectedRoute:{id:null,name:null},newName:""}},methods:{getRoutes:function(){this.session=this.activeSession,Y["a"].getRoutes(this.processRoutes,null,this.session)},saveRoute:function(t){Y["a"].putRoute(this.getRoutes,null,t)},deleteRoute:function(t){Y["a"].deleteRoute(this.getRoutes,null,t.id)},setSession:function(){},processRoutes:function(t){this.routes=t},selectRoute:function(t){t.id!==this.selectedRouteId&&(this.selectedRoute=t,this.selectedRouteId=t.id)},submitNew:function(t){var e=this;this.$q.loading.show();var n={name:t,sessionId:this.session,isReturn:this.isReturn};Y["a"].postRoute((function(t){e.selectedRoute=t,e.selectedRouteId=t.id,e.getRoutes(),e.$q.loading.hide()}),null,n)},newStop:function(t){Y["a"].postStop(this.getRoute,null,{routeId:this.selectedRouteId,name:t})},saveStop:function(t){Y["a"].putStop(this.getRoute,null,t)},deleteStop:function(t){Y["a"].deleteStop(this.getRoute,null,t.id)},getRoute:function(){var t=this,e=this.selectedRouteId;Y["a"].getRoute((function(e){t.selectedRoute=e}),null,e)},newCoach:function(t){Y["a"].postCoach(this.getRoute,null,{routeId:this.selectedRouteId,capacity:t})},saveCoach:function(t){Y["a"].putCoach(this.getRoute,null,t)},deleteCoach:function(t){Y["a"].deleteCoach(this.getRoute,null,t.id)}},watch:{selectedRouteId:function(){this.getRoute()},session:function(){this.getRoutes()}},computed:bt({},Object(h["c"])("transport",["activeSession"]),{isReturn:function(){return"outbound"===this.direction?1:0},activeRoutes:function(){var t=this,e=this.routes.filter((function(e){return e.isReturn===t.isReturn}));return e}}),components:{DeleteButton:ut["a"],NewButton:dt["a"],EditButton:pt["a"]},created:function(){var t=this;this.session>0&&this.$store.watch((function(){return t.$store.getters["transport/activeSession"]}),this.getRoutes),this.getRoutes()}},mt=ht,gt=(n("ae23"),Object(y["a"])(mt,lt,ct,!1,null,"a187e378",null)),vt=gt.exports,kt={name:"PageTransportCoaches",data:function(){return{elements:[{name:"bookings",component:G,icon:"fal fa-home",shortcut:"b"},{name:"new",labelx:"Overview",component:rt,icon:"fal fa-plus",shortcut:"c"},{name:"routes",labelx:"routes",icon:"fal fa-route",component:vt,shortcut:"s"}]}},components:{toolbarPage:a["a"]}},yt=kt,Ot=Object(y["a"])(yt,o,s,!1,null,null,null);e["default"]=Ot.exports}}]);