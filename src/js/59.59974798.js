(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[59],{"72df":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.house?s("div",[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-btn-toggle",{attrs:{spread:"","no-caps":"",dense:"","toggle-color":"tertiary",color:"secondary","text-color":"font-secondary","toggle-text-color":"accent",options:t.yearOptions,year:"full-width"},model:{value:t.selectedYear,callback:function(e){t.selectedYear=e},expression:"selectedYear"}})],1)]),s("div",{staticClass:"row "},[s("div",{staticClass:"col q-mx-lg",staticStyle:{"max-width":"800px"}},[s("q-markup-table",{staticClass:"q-mt-xs q-my-md",attrs:{dense:"",flat:"",bordered:""}},[s("thead",{staticClass:"q-mb-md"},[s("tr",{staticClass:"bg-tertiary"},[s("th",{staticClass:"text-left"},[t._v("Edit")]),s("th",{staticClass:"text-left"},[t._v("Name")]),s("th",{staticClass:"text-left"},[t._v("Note")])])]),s("tbody",t._l(t.filteredStudents,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[s("q-btn",{attrs:{dense:"",icon:"fad fa-edit",outline:"",color:"accent",size:"sm"},on:{click:function(s){return t.editNote(e.id)}}})],1),s("td",{staticClass:"text-left"},[t._v(t._s(e.displayName))]),s("td",{staticClass:"text-left"},[t._v(t._s(e.hmNote))])])})),0)])],1)]),t.selectedStudent?s("q-dialog",{staticStyle:{width:"300px"},attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.editOpen,callback:function(e){t.editOpen=e},expression:"editOpen"}},[s("q-card",{staticClass:"bg-primary text-font",staticStyle:{width:"450px"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[t._v(t._s(t.selectedStudent.displayName))])]),s("q-card-section",{staticClass:"full-width text-center bg-primary q-pa-xs"},[s("q-input",{staticClass:"bg-secondary q-px-xs",staticStyle:{widthx:"400px","min-height":"400px",margin:"auto 2px",border:"1px solid grey"},attrs:{filledx:"",type:"textarea",rows:"20"},model:{value:t.currentNote,callback:function(e){t.currentNote=e},expression:"currentNote"}})],1),s("q-card-actions",{staticClass:"bg-secondary text-font",attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Save",color:"positive"},on:{click:t.saveNote}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"warning"},on:{click:t.cancel}})],1)],1)],1):t._e()],1):t._e()},o=[],i=s("4778"),l={getHouses(t,e,s){i["a"].get("/hm/houses").then(e=>{t(e.data)}).catch(t=>{console.log(t)})},getNotes(t,e,s){i["a"].get("/hm/"+s+"/notes").then(e=>{t(e.data)}).catch(t=>{console.log(t)})},postNote(t,e,s,a){i["a"].post("/hm/"+s+"/notes",a).then(e=>{t(e.data)}).catch(t=>{console.log(t)})}},n={name:"HM.Notes",data(){return{house:null,students:[],currentNote:null,selectedYear:13,selectedStudent:null,yearOptions:[{value:13,label:"Upper Sixth"},{value:11,label:"Hundred"}],editOpen:!1}},methods:{cancel(){this.setHouse()},editNote(t){this.selectedStudent=this.students.find(e=>e.id===t),this.currentNote=this.selectedStudent.hmNote,this.editOpen=!0},setHouse(){this.house=this.$store.state.user.globalHouse,l.getNotes(t=>{this.students=t},this.$errorHandler,this.house.id)},saveNote(){this.selectedStudent.hmNote=this.currentNote,l.postNote(this.notifySaved,this.$errorHandler,this.house.id,this.selectedStudent)},notifySaved(){this.$q.notify({message:"Saved",color:"positive",textColor:"primary",position:"top"})}},computed:{filteredStudents(){return this.students.filter(t=>t.NCYear===this.selectedYear)}},components:{},created(){this.houseWatch=this.$store.watch(()=>this.$store.getters["user/getGlobalHouse"],this.setHouse),this.setHouse()},beforeDestroy(){this.houseWatch()}},c=n,r=s("2be6"),d=s("6dd6"),u=s("2e0b"),h=s("2ef0"),p=s("e81c"),m=s("ebe6"),f=s("965d"),g=s("bc74"),x=s("5b32"),b=s("58c0"),v=s("e279"),y=s.n(v),C=Object(r["a"])(c,a,o,!1,null,null,null);e["default"]=C.exports;y()(C,"components",{QBtnToggle:d["a"],QMarkupTable:u["a"],QBtn:h["a"],QDialog:p["a"],QCard:m["a"],QCardSection:f["a"],QInput:g["a"],QCardActions:x["a"]}),y()(C,"directives",{ClosePopup:b["a"]})}}]);