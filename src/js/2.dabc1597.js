(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"2ede":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"no-scroll full-height toolbar-page"},[s("div",{staticClass:"q-ma-lg",staticStyle:{"overflow-y":"scroll"}},[s("div",{staticClass:"row"},[s("q-btn",{staticClass:"text-positive new-button q-mr-md",staticStyle:{width:"100px"},attrs:{"icon-color":"positive",outline:"",icon:"fas fa-edit fa-xs",size:"md",dense:""},on:{click:function(e){t.dialogOpen=!0}}}),s("q-btn-toggle",{staticClass:"text-positive q-mr-lg",attrs:{outline:"","text-color":"font-secondary","toggle-text-color":"positive",options:[{label:"All",value:"all"},{label:"Alert Today",value:"alert_today"},{label:"Any Alert",value:"alert_any"}]},model:{value:t.filterModel,callback:function(e){t.filterModel=e},expression:"filterModel"}}),s("q-input",{staticClass:"col",attrs:{dense:"",outline:"",color:"font",placeholder:"Search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),s("div",{staticClass:"row fit"},[s("div",{staticClass:"col q-mt-md"},[s("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[t.loading?t._e():s("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[s("thead",{staticClass:"q-mb-md"},[s("tr",{staticClass:"bg-tertiary"},[s("th",{staticClass:"text-left"},[t._v("Name")]),t._l(t.dates,(function(e){return s("th",{key:e.date,staticClass:"text-left"},[t._v(t._s(e.prettyDate))])})),s("th",{staticClass:"text-left"})],2)]),s("tbody",t._l(t.visible,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[t._v(t._s(e.firstname+" "+e.lastname))]),t._l(t.dates,(function(t){return s("td",{key:t.date,staticClass:"text-left"},[s("answer",{attrs:{person:e,date:t.date}})],1)})),s("td",{staticClass:"text-left"})],2)})),0)])],1)],1)]),s("q-dialog",{staticClass:"bg-green",model:{value:t.dialogOpen,callback:function(e){t.dialogOpen=e},expression:"dialogOpen"}},[s("q-card",[s("q-card-section",{staticClass:"bg-secondary bd-font",staticStyle:{"min-width":"500px"}},[s("div",{staticClass:"text-h6"},[t._v("Manage Subscriptions")]),s("div",{staticClass:"row flex items-center q-py-md"},[s("users",{ref:"users",staticClass:"col q-pl-none q-pr-sm",attrs:{user:t.user},on:{"update:user":function(e){t.user=e}}}),s("q-btn",{staticStyle:{height:"40px",width:"150px"},attrs:{disabled:!t.user,outline:"",color:"positive",label:"Add"},on:{click:t.addUser}})],1),s("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[t.loading?t._e():s("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[s("tbody",t._l(t.staff,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[t._v(t._s(e.firstname+" "+e.lastname))]),s("td",{staticClass:"text-right"},[s("q-btn",{staticClass:"text-font-secondary",attrs:{size:"sm",outline:"",dense:"",icon:"fas fa-times"},on:{click:function(s){return t.removeUser(e.id)}}})],1)])})),0)])],1)],1)],1)],1)],1)])},l=[],i=(s("06ef"),s("632c"),s("4778")),n={getStaff(t,e){i["a"].get("/covid/staff").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},postStaff(t,e,s){i["a"].post("/covid/staff/"+s).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},deleteStaff(t,e,s){i["a"].delete("/covid/staff/"+s).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getResponses(t,e){i["a"].get("/covid/responses").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}},o=s("0142"),r=s("85b2"),c={name:"smt.covid.staff",props:{},data(){return{staff:[],search:"",filterModel:"all",loading:!0,dates:[],dialogOpen:!1,user:null}},methods:{process(t){this.$q.loading.hide(),this.loading=!1,this.staff=t.staff.sort(this.$compare("lastname")),this.dates=t.dates},addUser(){var t=this;n.postStaff((function(e){t.$refs.users.clear(),t.fetch()}),this.$errorHandler,this.user.id)},fetch(){n.getStaff(this.process,this.$errorHandler)},removeUser(t){n.deleteStaff(this.fetch,this.$errorHandler,t)}},computed:{visible(){var t=this,e=this.search;if(0===this.staff.length)return[];var s=[];return s="alert_today"===this.filterModel?this.staff.filter((function(e){var s=t.dates[0].date,a=e.answers.find((function(t){return t.date===s}));if(a)return 0===a.isHealthy&&1===a.hasAnswered})):"alert_any"===this.filterModel?this.staff.filter((function(t){if(t.answers[0])return t.answers.find((function(t){return 0===t.isHealthy&&1===t.hasAnswered}))})):this.staff,""===e?s:s.filter((function(t){return t.firstname.toLowerCase().indexOf(e)>-1||t.lastname.toLowerCase().indexOf(e)>-1}))}},components:{Answer:o["a"],Users:r["a"]},created(){this.$q.loading.show(),this.fetch()}},d=c,f=s("2be6"),u=s("8c42"),h=s("2ef0"),p=s("6dd6"),g=s("bc74"),m=s("26a8"),v=s("2e0b"),b=s("e81c"),C=s("ebe6"),x=s("965d"),y=s("e279"),q=s.n(y),w=Object(f["a"])(d,a,l,!1,null,"9d6ee106",null);e["default"]=w.exports;q()(w,"components",{QPage:u["a"],QBtn:h["a"],QBtnToggle:p["a"],QInput:g["a"],QScrollArea:m["a"],QMarkupTable:v["a"],QDialog:b["a"],QCard:C["a"],QCardSection:x["a"]})}}]);