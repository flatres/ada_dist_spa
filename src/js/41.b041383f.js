(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"0358":function(t,e,s){},"5fcd":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("toolbar-page",{attrs:{elements:t.elements}})},n=[],o=s("08e9"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"overflow-y":"scroll"}},[s("div",{staticClass:"row"},[s("q-btn-toggle",{staticClass:"text-positive q-mr-lg",attrs:{outline:"","text-color":"font-secondary","toggle-text-color":"positive",options:[{label:"Alert Today",value:"alert_today"},{label:"Any Alert",value:"alert_any"},{label:"All",value:"all"}]},model:{value:t.filterModel,callback:function(e){t.filterModel=e},expression:"filterModel"}}),s("q-input",{staticClass:"col",attrs:{dense:"",outline:"",color:"font",placeholder:"Search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),s("div",{staticClass:"row fit"},[s("div",{staticClass:"col q-mt-md"},[s("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[t.loading?t._e():s("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[s("thead",{staticClass:"q-mb-md"},[s("tr",{staticClass:"bg-tertiary"},[s("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("name")}}},[t._v("Name")]),s("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("boardingHouse")}}},[t._v("House")]),s("th",{staticClass:"text-left",on:{click:function(e){return t.setSort("NCYear")}}},[t._v("Yr")]),t._l(t.dates,(function(e){return s("th",{key:e.date,staticClass:"text-left"},[t._v(t._s(e.prettyDate))])})),s("th",{staticClass:"text-left"})],2)]),s("tbody",t._l(t.sorted,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[t._v(t._s(e.lastname+",  "+e.prename))]),s("td",{staticClass:"text-left"},[t._v(t._s(e.boardingHouse))]),s("td",{staticClass:"text-left"},[t._v(t._s(e.NCYear))]),t._l(t.dates,(function(t){return s("td",{key:t.date,staticClass:"text-left"},[s("answer",{attrs:{person:e,date:t.date}})],1)})),s("td",{staticClass:"text-left"})],2)})),0)])],1)],1)])])},r=[],l=(s("a7e1"),s("76d0"),s("288e"),s("06ef"),s("4778")),c={getStaff:function(t,e){l["a"].get("/smt/covid/staff").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getStudents:function(t,e){l["a"].get("/smt/covid/students").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},postStudentEmails:function(t,e){l["a"].post("/smt/covid/students").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},postStaffEmails:function(t,e){l["a"].post("/smt/covid/staff").then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}},d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-badge",{attrs:{color:t.color,outline:t.outline}},[s("q-icon",{attrs:{name:t.icon,color:t.iconColor}}),s("q-tooltip",[t._v(t._s(t.tooltip))])],1)},f=[],u={name:"covid.ui.answer",props:{person:{type:Object,require:!0},date:{type:String,required:!0}},data:function(){return{}},methods:{},computed:{answer:function(){var t=this;return this.person.answers.find((function(e){return e.date===t.date}))},icon:function(){var t=this.answer;return t?1===t.isHealthy?"fas fa-check":0===t.isHealthy&&1===t.hasAnswered?"fas fa-biohazard":0===t.hasAnswered?"fas fa-question":1===t.isNotInWork?"fas fa-sign-out-alt":void 0:""},color:function(){var t=this.answer;return t?1===t.isHealthy?"positive":0===t.isHealthy&&1===t.hasAnswered?"warning":0===t.hasAnswered?"font-secondary":1===t.isNotInWork?"font":void 0:"font-secondary"},iconColor:function(){var t=this.answer;return t?1===t.isHealthy?"positive":0===t.isHealthy&&1===t.hasAnswered?"primary":0===t.hasAnswered?"orange":1===t.isNotInWork?"font":void 0:"font-secondary"},outline:function(){var t=this.answer;return!t||(0!==t.isHealthy||1!==t.hasAnswered)},tooltip:function(){var t=this.answer;return t?1===t.isHealthy?"healthy":0===t.isHealthy&&1===t.hasAnswered?"covid risk":0===t.hasAnswered?"not answered":1===t.isNotInWork?"not in work":void 0:"record not found"}},components:{},created:function(){}},p=u,h=(s("b61f"),s("2be6")),m=s("f987"),v=s("34ff"),b=s("3aaf"),y=s("e279"),C=s.n(y),g=Object(h["a"])(p,d,f,!1,null,"1d92a1e9",null),w=g.exports;C()(g,"components",{QBadge:m["a"],QIcon:v["a"],QTooltip:b["a"]});var x={name:"smt.covid.students",props:{},data:function(){return{students:[],search:"",filterModel:"alert_today",loading:!0,dates:[],sortKey:"lastname",sortDir:"asc"}},methods:{process:function(t){this.$q.loading.hide(),this.loading=!1,this.students=t.students,this.dates=t.dates},setSort:function(t){t===this.sortKey&&(this.sortDir="asc"===this.sortDir?"desc":"asc"),this.sortKey=t}},computed:{visible:function(){var t=this,e=this.search,s=[];return s="alert_today"===this.filterModel?this.students.filter((function(e){var s=t.dates[0].date,a=e.answers.find((function(t){return t.date===s}));if(a)return 0===a.isHealthy&&1===a.hasAnswered})):"alert_any"===this.filterModel?this.students.filter((function(t){if(t.answers[0])return t.answers.find((function(t){return 0===t.isHealthy&&1===t.hasAnswered}))})):this.students,""===e?s:s.filter((function(t){return t.firstname.toLowerCase().indexOf(e)>-1||t.lastname.toLowerCase().indexOf(e)>-1||t.prename.toLowerCase().indexOf(e)>-1||t.boardingHouse.toLowerCase().indexOf(e)>-1||t.NCYear.toString().toLowerCase().indexOf(e)>-1}))},sorted:function(){var t=this.visible.filter((function(t){return t.id>0}));return t.sort(this.$compare(this.sortKey,this.sortDir))}},components:{Answer:w},created:function(){this.$q.loading.show(),c.getStudents(this.process,this.$errorHandler)}},q=x,_=s("6dd6"),S=s("bc74"),k=s("26a8"),A=s("2e0b"),Q=Object(h["a"])(q,i,r,!1,null,"86da297a",null),H=Q.exports;C()(Q,"components",{QBtnToggle:_["a"],QInput:S["a"],QScrollArea:k["a"],QMarkupTable:A["a"]});var M=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"overflow-y":"scroll"}},[s("div",{staticClass:"row"},[s("q-btn-toggle",{staticClass:"text-positive q-mr-lg",attrs:{outline:"","text-color":"font-secondary","toggle-text-color":"positive",options:[{label:"Alert Today",value:"alert_today"},{label:"Any Alert",value:"alert_any"},{label:"All",value:"all"}]},model:{value:t.filterModel,callback:function(e){t.filterModel=e},expression:"filterModel"}}),s("q-input",{staticClass:"col",attrs:{dense:"",outline:"",color:"font",placeholder:"Search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),s("div",{staticClass:"row fit"},[s("div",{staticClass:"col q-mt-md"},[s("q-scroll-area",{staticClass:"column",staticStyle:{height:"75vh"}},[t.loading?t._e():s("q-markup-table",{staticClass:"q-mb-xl",attrs:{dense:"",flat:"",bordered:""}},[s("thead",{staticClass:"q-mb-md"},[s("tr",{staticClass:"bg-tertiary"},[s("th",{staticClass:"text-left"},[t._v("Name")]),t._l(t.dates,(function(e){return s("th",{key:e.date,staticClass:"text-left"},[t._v(t._s(e.prettyDate))])})),s("th",{staticClass:"text-left"})],2)]),s("tbody",t._l(t.visible,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[t._v(t._s(e.firstname+" "+e.lastname))]),t._l(t.dates,(function(t){return s("td",{key:t.date,staticClass:"text-left"},[s("answer",{attrs:{person:e,date:t.date}})],1)}))],2)})),0)])],1)],1)])])},$=[],N={name:"smt.covid.staff",props:{},data:function(){return{staff:[],search:"",filterModel:"alert_today",loading:!0,dates:[]}},methods:{process:function(t){this.$q.loading.hide(),this.loading=!1,this.staff=t.staff,this.dates=t.dates}},computed:{visible:function(){var t=this,e=this.search,s=[];return s="alert_today"===this.filterModel?this.staff.filter((function(e){var s=t.dates[0].date,a=e.answers.find((function(t){return t.date===s}));if(a)return 0===a.isHealthy&&1===a.hasAnswered})):"alert_any"===this.filterModel?this.staff.filter((function(t){if(t.answers[0])return t.answers.find((function(t){return 0===t.isHealthy&&1===t.hasAnswered}))})):this.staff,""===e?s:s.filter((function(t){return t.firstname.toLowerCase().indexOf(e)>-1||t.lastname.toLowerCase().indexOf(e)>-1}))}},components:{Answer:w},created:function(){this.$q.loading.show(),c.getStaff(this.process,this.$errorHandler)}},O=N,E=Object(h["a"])(O,M,$,!1,null,"1161f256",null),T=E.exports;C()(E,"components",{QBtnToggle:_["a"],QInput:S["a"],QScrollArea:k["a"],QMarkupTable:A["a"]});var I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{},[s("div",{staticClass:"row fit q-gutter-xs",staticStyle:{"max-width":"300 px"}},[s("q-card",{staticClass:"col",attrs:{outline:""}},[s("q-card-section",{staticClass:"bg-tertiary"},[s("span",{staticClass:"text-bold q-mb-md"},[t._v("Pupils")]),s("br"),s("q-toggle",{staticClass:"font-secondary col q-mt-xl",attrs:{"false-value":0,"true-value":1,label:"System Active",color:"positive"},model:{value:t.status.pupils.active,callback:function(e){t.$set(t.status.pupils,"active",e)},expression:"status.pupils.active"}}),s("q-btn",{staticClass:"text-positive col q-mt-xl full-width",attrs:{label:"Send Today's Email",outline:""},on:{click:function(e){t.confirmStudents=!0}}})],1)],1),s("q-card",{staticClass:"col",attrs:{outline:""}},[s("q-card-section",{staticClass:"bg-tertiary"},[s("span",{staticClass:"text-bold q-mb-md"},[t._v("Staff")]),s("br"),s("q-toggle",{staticClass:"font-secondary col q-mt-xl",attrs:{"false-value":0,"true-value":1,label:"System Active",color:"positive"},model:{value:t.status.staff.active,callback:function(e){t.$set(t.status.staff,"active",e)},expression:"status.staff.active"}}),s("q-btn",{staticClass:"text-positive col q-mt-xl full-width",attrs:{label:"Send Today's Email",outline:""},on:{click:function(e){t.confirmStaff=!0}}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.confirmStudents,callback:function(e){t.confirmStudents=e},expression:"confirmStudents"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[s("span",{staticClass:"q-ml-sm"},[t._v("Are you sure about this?")])]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-font",attrs:{outline:"",label:"Cancel",color:"font"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-positive",attrs:{outline:"",label:"I am",color:"primary"},on:{click:t.sendStudents}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.confirmStaff,callback:function(e){t.confirmStaff=e},expression:"confirmStaff"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[s("span",{staticClass:"q-ml-sm"},[t._v("Are you sure about this?")])]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-font",attrs:{outline:"",label:"Cancel",color:"font"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-positive",attrs:{outline:"",label:"I am",color:"primary"},on:{click:t.sendStaff}})],1)],1)],1)],1)},D=[],L={name:"smt.covid.control",props:{},data:function(){return{status:{pupils:{active:0},staff:{active:0}},confirmStudents:!1,confirmStaff:!1}},methods:{sendStaff:function(){c.postStaffEmails()},sendStudents:function(){c.postStudentEmails()}},computed:{},components:{},created:function(){}},j=L,P=s("8c42"),W=s("ebe6"),B=s("965d"),K=s("3d3c"),Y=s("2ef0"),J=s("e81c"),z=s("9f30"),F=s("5b32"),G=s("58c0"),R=Object(h["a"])(j,I,D,!1,null,"b7742bce",null),U=R.exports;C()(R,"components",{QPage:P["a"],QCard:W["a"],QCardSection:B["a"],QToggle:K["a"],QBtn:Y["a"],QDialog:J["a"],QAvatar:z["a"],QCardActions:F["a"]}),C()(R,"directives",{ClosePopup:G["a"]});var V={name:"PageSMTWatch",data:function(){return{elements:[{name:"students",label:"Pupils Qs",component:H},{name:"staff",label:"Staff Qs",component:T},{name:"control",label:"Control Qs",component:U}]}},components:{toolbarPage:o["a"]}},X=V,Z=Object(h["a"])(X,a,n,!1,null,null,null);e["default"]=Z.exports},b61f:function(t,e,s){"use strict";var a=s("0358"),n=s.n(a);n.a}}]);