(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[25],{5879:function(t,e,s){"use strict";var a=s("7e52"),o=s.n(a);o.a},"7e52":function(t,e,s){},8426:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("toolbar-page",{attrs:{elements:t.elements,default:"jobs"}})},o=[],n=s("08e9"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row fitx q-mt-md"},[s("div",{staticClass:"col q-gutter-md column flex justify-between"},[s("q-card",{attrs:{outlined:""}},[s("q-card-section",{staticClass:"bg-tertiary q-gutter-y-md"},[s("q-input",{attrs:{dense:"",color:"font",outlined:"",label:"Name","stack-label":""},model:{value:t.job_.name,callback:function(e){t.$set(t.job_,"name",e)},expression:"job_.name"}}),s("q-input",{attrs:{dense:"",color:"font",outlined:"",label:"Description","stack-label":"",type:"textarea"},model:{value:t.job_.description,callback:function(e){t.$set(t.job_,"description",e)},expression:"job_.description"}})],1)],1),s("q-card",{staticClass:"q-pt-sm",attrs:{outlined:""}},[s("q-card-section",{staticClass:"bg-tertiary q-gutter-y-md"},[t._v("\n          Preset Frequency\n         "),s("q-select",{attrs:{dense:"",color:"font",outlined:"",options:t.freqOptions,label:"Preset Frequency"},model:{value:t.job_.preset_freq,callback:function(e){t.$set(t.job_,"preset_freq",e)},expression:"job_.preset_freq"}})],1),s("q-card-section",{staticClass:"bg-tertiary q-gutter-y-md"},[t._v("\n         Custom Frequency\n         "),s("div",{staticClass:"row full-width justify-center q-gutter-x-xs"},[s("q-badge",{staticClass:"col bg-positive text-black text-center text-bold",attrs:{color:"postive"}},[t._v("Every")]),s("q-input",{attrs:{dense:"",color:"font",outlined:"",placeholder:"Digit","stack-label":""},model:{value:t.job_.unit_value,callback:function(e){t.$set(t.job_,"unit_value",e)},expression:"job_.unit_value"}}),s("q-select",{staticClass:"col-5",attrs:{dense:"",color:"font",outlined:"",options:t.unitKeyOptions},model:{value:t.job_.unit_key,callback:function(e){t.$set(t.job_,"unit_key",e)},expression:"job_.unit_key"}})],1),s("p",{staticClass:"text-font"},[t._v("This will override the preset frequency.")])])],1),s("q-card",{staticClass:"q-pt-sm",attrs:{outlined:""}},[s("q-card-section",{staticClass:"bg-tertiary q-gutter-y-md"},[t._v("\n         Run At\n         "),s("div",{staticClass:"row full-width justify-center q-gutter-x-xs"},[s("q-input",{staticClass:"col",attrs:{outlined:"",dense:"",mask:"time",placeholder:"HH:mm",color:"font"},model:{value:t.job_.run_at,callback:function(e){t.$set(t.job_,"run_at",e)},expression:"job_.run_at"}}),s("q-select",{staticClass:"col",attrs:{dense:"",color:"font",outlined:"",options:t.dayOfWeekOptions},model:{value:t.job_.day_of_week,callback:function(e){t.$set(t.job_,"day_of_week",e)},expression:"job_.day_of_week"}})],1)])],1)],1),s("div",{staticClass:"col q-ml-lg"},[s("q-card",{attrs:{outlined:""}},[s("q-card-section",{staticClass:"bg-tertiary q-gutter-md"},[t._v("\n           Wake Up On\n           "),s("div",{staticClass:"row full-width justify-center q-gutter-x-xs"},[s("q-input",{staticClass:"col",attrs:{outlined:"",dense:"",mask:"date",placeholder:"YYYY/MM/DD",color:"font"},model:{value:t.job_.up_date,callback:function(e){t.$set(t.job_,"up_date",e)},expression:"job_.up_date"}}),s("q-input",{staticClass:"col",attrs:{outlined:"",dense:"",mask:"time",placeholder:"HH:mm",color:"font"},model:{value:t.job_.up_time,callback:function(e){t.$set(t.job_,"up_time",e)},expression:"job_.up_time"}})],1),s("br"),t._v("\n           Sleep On\n           "),s("div",{staticClass:"row full-width justify-center q-gutter-x-xs"},[s("q-input",{staticClass:"col",attrs:{outlined:"",dense:"",mask:"date",placeholder:"YYYY/MM/DD",color:"font"},model:{value:t.job_.sleep_date,callback:function(e){t.$set(t.job_,"sleep_date",e)},expression:"job_.sleep_date"}}),s("q-input",{staticClass:"col",attrs:{outlined:"",dense:"",mask:"time",placeholder:"HH:mm",color:"font"},model:{value:t.job_.sleep_time,callback:function(e){t.$set(t.job_,"sleep_time",e)},expression:"job_.sleep_time"}})],1)])],1),s("br"),s("q-card",{staticClass:"q-pt-sm",attrs:{outlined:""}},[s("q-card-section",{staticClass:"bg-tertiary q-gutter-md"},[t._v("\n          State\n          "),s("div",{staticClass:"row"},[s("q-toggle",{staticClass:"font-secondary col",attrs:{"false-value":0,"true-value":1,label:"Sleep during holidays and exeats",c:"",olor:"positive"},model:{value:t.job_.term_time_only,callback:function(e){t.$set(t.job_,"term_time_only",e)},expression:"job_.term_time_only"}}),s("q-toggle",{staticClass:"font-secondary col",attrs:{"false-value":0,"true-value":1,label:"Prevent Overlapping",color:"positive"},model:{value:t.job_.prevent_overlapping,callback:function(e){t.$set(t.job_,"prevent_overlapping",e)},expression:"job_.prevent_overlapping"}})],1),s("div",{staticClass:"row"},[s("q-toggle",{staticClass:"font-secondary col",attrs:{"false-value":0,"true-value":1,label:"Task Is Active",color:"positive"},model:{value:t.job_.active,callback:function(e){t.$set(t.job_,"active",e)},expression:"job_.active"}})],1)])],1),s("br"),s("q-card",{staticClass:"q-pt-sm",attrs:{outlined:""}},[s("q-card-section",{staticClass:"bg-tertiary q-gutter-md"},[t._v("\n          Script\n          "),s("q-select",{staticClass:"col",attrs:{dense:"",color:"font",outlined:"",options:t.scriptOptions},model:{value:t.job_.script,callback:function(e){t.$set(t.job_,"script",e)},expression:"job_.script"}}),s("div",{staticClass:"row"},[t._v(t._s(t.scriptPath))])],1)],1),s("br"),s("q-card",{staticClass:"q-pt-sm",attrs:{outlined:""}},[s("q-card-section",{staticClass:"bg-tertiary q-gutter-md"},[t.job?s("div",{staticClass:"row q-gutter-x-sm"},[s("q-btn",{staticClass:"text-positive col",attrs:{label:"save",outline:"",color:"positive"},on:{click:t.saveJob}}),s("q-btn",{staticClass:"text-positive col",attrs:{label:"delete",outline:"",color:"warning"},on:{click:t.deleteJob}})],1):t._e(),t.job?t._e():s("div",{staticClass:"row q-gutter-x-sm"},[s("q-btn",{staticClass:"text-positive col",attrs:{label:"create",outline:"",color:"positive",disabled:t.btnDisabled},on:{click:t.createJob}})],1)])],1)],1)])},l=[],r=(s("c880"),s("288e"),s("ebdc")),c={name:"PageResults",props:{job:{type:Object}},data:function(){return{job_:{id:null,name:"",description:"",preset_freq:null,unit_value:null,unit_key:"hour",run_at:null,day_of_week:"weekdays",up_time:null,up_date:null,sleep_time:null,sleep_date:null,term_time_only:0,prevent_overlapping:1,active:0,script:null,run_in:null},freqOptions:[null,"hourly","daily","yearly","quarterly","yearly"],unitKeyOptions:["hour","minutes","day","month"],dayOfWeekOptions:["weekdays","mondays","tuesdays","wednesdays","thursdays","fridays","saturdays","sundays"],scripts:[]}},methods:{createJob:function(){var t=this;this.job_.run_in=this.scriptPath,this.job_.unit_value&&0===this.job_.unit_value.length&&(this.job_.unit_value=null),r["a"].postJob((function(e){t.returnToJobs()}),this.$errorHandler,this.job_)},saveJob:function(){var t=this;this.job_.run_in=this.scriptPath,this.job_.unit_value&&0===this.job_.unit_value.length&&(this.job_.unit_value=null),r["a"].putJob((function(e){t.returnToJobs()}),this.$errorHandler,this.job_)},deleteJob:function(){var t=this;r["a"].deleteJob((function(e){t.returnToJobs()}),this.$errorHandler,this.job_.id)},returnToJobs:function(){this.job?this.$emit("close"):this.$router.push({path:"/admin/jobs"})}},computed:{scriptOptions:function(){return this.scripts.map((function(t){return t.file}))},scriptPath:function(){var t=this;if(!this.job_.script)return"";var e=this.scripts.find((function(e){return e.file===t.job_.script}));return e?e.path:""},btnDisabled:function(){return 0===this.job_.name.length}},components:{},created:function(){var t=this;r["a"].getScripts((function(e){t.scripts=e}),this.$errorHandler),this.job&&(this.job_=this.job)}},u=c,d=(s("efdd"),s("2be6")),b=s("8c42"),p=s("ebe6"),_=s("965d"),m=s("bc74"),f=s("3946"),v=s("f987"),j=s("3d3c"),h=s("2ef0"),q=s("e279"),g=s.n(q),y=Object(d["a"])(u,i,l,!1,null,"43236ef6",null),C=y.exports;g()(y,"components",{QPage:b["a"],QCard:p["a"],QCardSection:_["a"],QInput:m["a"],QSelect:f["a"],QBadge:v["a"],QToggle:j["a"],QBtn:h["a"]});var k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("crud",{ref:"crud",attrs:{api:t.api,columns:t.columns,search:"",sortBy:"name",reverse:"",channel:"admin.jobs",indicator:"active",actions:t.actions},on:{editJob:t.editJob}}),s("q-dialog",{attrs:{maximized:""},model:{value:t.editOpen,callback:function(e){t.editOpen=e},expression:"editOpen"}},[s("q-card",{staticClass:"bg-secondary text-white"},[s("q-bar",{staticClass:"bg-tertiary"},[s("q-space"),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[s("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[t._v("Close")])],1)],1),s("br"),s("q-card-section",{staticClass:"q-pt-none"},[s("job",{attrs:{job:t.currentJob},on:{close:t.closeEdit}})],1)],1)],1)],1)},x=[],w=s("d612"),J={name:"Component.Admin.Logs.Access",data:function(){return{api:{get:r["a"].getJobs},columns:[{name:"id",label:"id",field:"id",type:"string",align:"left",hidden:!0},{name:"name",label:"Name",field:"name",type:"string",align:"left",sortable:!0},{name:"script",label:"Script",field:"script",type:"string",align:"left",sortable:!0},{name:"last_run",label:"Last Run",field:"last_run",type:"string",align:"left",sortable:!0}],actions:[{title:"Edit",event:"editJob",icon:"fal fa-edit"}],currentJob:null,editOpen:!1}},methods:{editJob:function(t){this.currentJob=t,this.editOpen=!0},closeEdit:function(){this.editOpen=!1,this.$refs.crud.get()}},computed:{},components:{Crud:w["a"],Job:C},created:function(){}},$=J,O=(s("5879"),s("e81c")),Q=s("5d16"),P=s("f962c"),H=s("3aaf"),S=s("58c0"),D=Object(d["a"])($,k,x,!1,null,"47bc2f8d",null),T=D.exports;g()(D,"components",{QDialog:O["a"],QCard:p["a"],QBar:Q["a"],QSpace:P["a"],QBtn:h["a"],QTooltip:H["a"],QCardSection:_["a"]}),g()(D,"directives",{ClosePopup:S["a"]});var Y={name:"PageAdminJobs",data:function(){return{elements:[{name:"jobs",label:"Jobs",component:T},{name:"new",label:"New Job",component:C}]}},components:{toolbarPage:n["a"]},methods:{refresh:function(){}}},E=Y,A=Object(d["a"])(E,a,o,!1,null,null,null);e["default"]=A.exports},c862:function(t,e,s){},efdd:function(t,e,s){"use strict";var a=s("c862"),o=s.n(a);o.a}}]);