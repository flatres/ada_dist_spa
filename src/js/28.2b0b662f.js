(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{3377:function(t,s,e){},"456f":function(t,s,e){},ab73:function(t,s,e){"use strict";var a=e("3377"),l=e.n(a);l.a},d497:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return t.getGlobalSubject?e("q-page",{},[e("exam-bar",{staticClass:"bg-tertiary",on:{loaded:function(s){t.showClasses=!0}}}),e("loading",{attrs:{loading:t.autoAssigning,messagex:t.autoCount+" / "+t.meetingsCount}}),!t.autoAssigning&&t.showClasses?e("div",{staticClass:"row full-width bg-secondary q-ma-md q-pl-md"},[e("div",{staticClass:"col"},[e("classes",{attrs:{classes:t.classes},on:{"update:classes":function(s){t.classes=s},publish:t.teachers}})],1),e("div",{staticClass:"ada-sidebar q-mx-sm"},[e("div",{staticClass:"full-width text-center bg-tertiary q-pb-lg"},[e("q-circular-progress",{staticClass:"text-white q-ma-md",attrs:{"show-value":"",value:t.progress,size:"90px",thickness:.2,color:"accent","center-color":"tertiary","track-color":"secondary",max:1}},[e("div",{staticClass:"absolute-full flex flex-center",staticStyle:{"font-size":"14px"}},[t._v("\n            "+t._s(t.bookedCount)+" / "+t._s(t.meetingsCount)+"\n          ")])]),e("div",{staticClass:"row full-width q-px-md q-mb-md"},[e("q-btn",{staticClass:"full-width",attrs:{outline:"",color:"accent",label:"Auto Assign"},on:{click:t.autoAssign}})],1),e("div",{staticClass:"row full-width q-px-md q-mb-md"},[e("q-btn",{staticClass:"full-width",attrs:{outline:"",color:"font",label:"Download",iconx:"fad fa-download"},on:{click:t.download}})],1),t.teachers.length>0?e("q-markup-table",{staticClass:"q-mx-md",attrs:{dense:"",flat:"",bordered:""}},[e("tbody",t._l(t.teachers,(function(s){return e("tr",{key:s.id},[e("td",{staticClass:"text-left"},[t._v(t._s(s.name))]),e("td",{staticClass:"text-left"},[t._v(t._s(s.count))])])})),0)]):t._e()],1)])]):t._e()],1):t._e()},l=[],i=(e("e125"),e("4823"),e("2e73"),e("76d0"),e("632c"),e("8e9e")),n=e.n(i),o=e("10ac"),r=e("9ce4"),c=e("89cf"),d=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("loading",{attrs:{loading:t.loadingClasses}}),!t.loadingClasses&&t.show&&t.classes.length>0?e("div",{staticClass:"row no-wrap q-px-xs q-pt-xs text-left",staticStyle:{"padding-bottom":"200px"}},[e("div",{staticClass:"q-mr-md",staticStyle:{"min-width":"150px"}},[e("q-scroll-area",{staticStyle:{height:"80vh"}},[e("q-list",{staticClass:"no-padding"},t._l(t.classes,(function(s){return e("q-item",{key:s.code,staticClass:"q-pa-xs text-white bg-tertiary q-my-xs",class:s.id===t.selectedClassId?"active-class":"",style:s.id===t.selectedClassId?"border: 2px solid black":"border: 1px solid grey",attrs:{clickable:"",group:"classes",dense:""},on:{click:function(e){return t.setClass(s.id)}}},[e("q-item-section",[e("q-item-label",{staticClass:"xrow"},[e("q-btn",{staticClass:"fullx-width",attrs:{flat:"",color:"font",label:s.code,dense:"","no-caps":"",size:"12px"}})],1)],1),e("q-item-section",{attrs:{side:""}},[t.classComplete(s)?e("q-icon",{attrs:{name:"fad fa-check",color:"positive"}}):t._e()],1)],1)})),1)],1)],1),e("div",{staticClass:"col"},[e("loading",{attrs:{loading:t.loading}}),!t.loading&&t.selectedClass?e("q-markup-table",{attrs:{dense:"",flat:"",bordered:""}},[e("thead",{staticClass:"q-mb-md"},[e("tr",{staticClass:"bg-tertiary"},[e("th",{staticClass:"text-left"},[t._v("Name")]),e("th",{staticClass:"text-left"},[t._v("Class")]),e("th",[t._v("Meeting Beak\n            ")])])]),e("tbody",t._l(t.selectedClass.students,(function(s){return e("tr",{key:s.id},[e("td",{staticClass:"text-left"},[t._v(t._s(s.fullName))]),e("td",{staticClass:"text-left"},[t._v(t._s(t.classCode))]),e("td",[e("q-btn-toggle",{staticClass:"no-shadow",attrs:{spread:"",outline:!s.meetingBeakId,dense:"","no-caps":"","toggle-color":"tertiary",color:"secondary","text-color":s.meetingBeakId?"grey-5":"warning",options:t.beakOptions},on:{input:function(e){return t.setBeak(s)}},model:{value:s.meetingBeakId,callback:function(e){t.$set(s,"meetingBeakId",e)},expression:"s.meetingBeakId"}})],1)])})),0)]):t._e()],1)]):t._e()],1)},u=[],h=e("0603"),g={name:"HOD.Data.MLO",props:{},data(){return{year:null,exam:null,subject:null,students:[],maxMLOCount:4,classes:[],selectedClassId:null,selectedClass:null,show:!1,exams:[],teachers:[],loading:!1,loadingClasses:!0}},methods:{classComplete(t){var s=t.students.filter(t=>t.meetingBeakId).length;return s===t.students.length},setBeak(t){h["a"].setMeeting(this.publish,this.$errorHandler,t.id,t.meetingBeakId,t.classId),console.log(t)},publish(){this.$emit("update:classes",this.classes)},processClasses(t){this.classes=t,this.loadingClasses=!1,this.classes.length>0&&(this.show=!0,this.setClass(this.classes[0].id)),this.publish()},getMeetingClasses(){console.log("gmc",this.$store.getters["user/getGlobalSubject"]),this.loadingClasses=!0,h["a"].getMeetingClasses(this.processClasses,this.$errorFunction)},setClass(t){this.selectedClassId=t,this.selectedClass=this.classes.find(s=>s.id===t)}},computed:{classCode(){return this.selectedClass.code},beakOptions(){var t=this.selectedClass.teachers.map(t=>({label:t.login,value:t.id}));return t}},components:{Loading:o["a"]},mounted(){this.getMeetingClasses()},created(){this.subject=this.$store.getters["user/getGlobalSubject"],this.yearWatch=this.$store.watch(()=>this.$store.getters["hod/activeYear"],this.getMeetingClasses),this.examWatch=this.$store.watch(()=>this.$store.getters["hod/activeExam"],this.getMeetingClasses)},beforeDestroy(){this.subjectWatch(),this.yearWatch(),this.examWatch()}},m=g,b=(e("fc54"),e("2be6")),f=e("26a8"),p=e("6c93"),C=e("ac9b"),v=e("66dc"),w=e("7d9a"),x=e("2ef0"),k=e("34ff"),y=e("2e0b"),q=e("6dd6"),O=e("e279"),_=e.n(O),j=Object(b["a"])(m,d,u,!1,null,"507535a6",null),I=j.exports;function B(t,s){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter((function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),e.push.apply(e,a)}return e}function $(t){for(var s=1;s<arguments.length;s++){var e=null!=arguments[s]?arguments[s]:{};s%2?B(Object(e),!0).forEach((function(s){n()(t,s,e[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):B(Object(e)).forEach((function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(e,s))}))}return t}_()(j,"components",{QScrollArea:f["a"],QList:p["a"],QItem:C["a"],QItemSection:v["a"],QItemLabel:w["a"],QBtn:x["a"],QIcon:k["a"],QMarkupTable:y["a"],QBtnToggle:q["a"]});var A={name:"Page.HOD.Meetings",data(){return{classes:[],autoAssigning:!1,autoCount:0,showClasses:!1}},computed:$($({},Object(r["c"])("user",["getGlobalSubject"])),{},{meetingsCount(){var t=0;return this.classes.forEach(s=>{t+=s.students.length}),t},bookedCount(){var t=0;return this.classes.forEach(s=>{t+=s.students.filter(t=>t.meetingBeakId).length}),t},teachers(){var t=[];return this.classes.forEach(s=>{s.students.forEach(e=>{var a=t.find(t=>t.id===e.meetingBeakId);if(a)a.count++;else{var l=s.teachers.find(t=>t.id===e.meetingBeakId);l&&t.push({name:l.login,id:l.id,count:1})}})}),t.sort(this.$compare("name")),t},progress(){return 0===this.meetingsCount?0:this.bookedCount/this.meetingsCount}}),methods:$($({},Object(r["d"])("hod",["setActiveYear"])),{},{autoAssign(){this.$q.dialog({title:"Confirm",message:"Would you like to automatically assign beaks to pupils?",cancel:!0,persistent:!0}).onOk(()=>{this.doAutoAssign()}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})},doAutoAssign(){this.autoAssigning=!0,this.autoCount=0,this.classes.forEach(t=>{var s=0,e=t.teachers.length;t.students.forEach(a=>{var l=t.teachers[s%e].id;h["a"].setMeeting(t=>{a.meetingBeakId=l,this.autoCount++,1===this.progress&&(this.autoAssigning=!1)},this.$errorHandler,a.id,l,t.id),s++})})},download(){h["a"].download(t=>{this.$downloadBlob(t.url,t.file)},this.$errorHandler)}}),components:{ExamBar:c["a"],Classes:I,Loading:o["a"]},created(){this.setActiveYear(12)},beforeDestroy(){}},M=A,Q=(e("ab73"),e("8c42")),E=e("cf19"),S=Object(b["a"])(M,a,l,!1,null,null,null);s["default"]=S.exports;_()(S,"components",{QPage:Q["a"],QCircularProgress:E["a"],QBtn:x["a"],QMarkupTable:y["a"]})},fc54:function(t,s,e){"use strict";var a=e("456f"),l=e.n(a);l.a}}]);