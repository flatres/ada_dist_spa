(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[30],{"2d70":function(t,e,a){"use strict";var s=a("d9bc"),n=a.n(s);n.a},d9bc:function(t,e,a){},f840:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("toolbar-page",{attrs:{elements:t.elements,default:"calendar"}})},n=[],l=a("08e9"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{},[a("div",{staticClass:"row fit",staticStyle:{height:"90vh"}},[a("div",{staticClass:"col fit",staticStyle:{height:"90vh"}},[a("Calendar",{key:t.calIndex,ref:"calendar",staticStyle:{"min-height":"90vh"},attrs:{"week-start":"1",year:t.year,"enable-range-selection":!0,"data-source":t.calendarData,sync:""},on:{"click-day":t.clickDay,"year-changed":t.changeYear}})],1),a("div",{staticClass:"col-3 q-ml-md",staticStyle:{"min-width":"310px"}},[a("q-toggle",{attrs:{label:"Show Week A/B","left-label":"",color:"accent"},on:{input:t.calendarData},model:{value:t.showWeeks,callback:function(e){t.showWeeks=e},expression:"showWeeks"}}),t._l(t.terms,(function(e){return a("q-list",{key:e.id,staticClass:"rounded-borders q-mb-xs",attrs:{padding:"",bordered:""}},[a("q-expansion-item",{attrs:{dense:"","dense-toggle":"","expand-separator":"",label:e.name}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"row"},[a("q-toggle",{attrs:{label:"Publish","left-label":"",color:"accent","true-value":1,"false-value":0},on:{input:t.save},model:{value:e.isPublished,callback:function(a){t.$set(e,"isPublished",a)},expression:"term.isPublished"}}),a("q-btn",{staticClass:"q-mt-sm q-ml-xl",staticStyle:{width:"120px",height:"25px"},attrs:{outline:"",color:"accent",label:"Update",dense:"",size:"sm"},on:{click:t.save}})],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-mr-xs",attrs:{color:"font",dense:"",label:"Start",mask:"##-##-#### ##:##"},model:{value:e.start,callback:function(a){t.$set(e,"start",a)},expression:"term.start"}}),a("q-input",{staticClass:"col q-pl-xs",attrs:{color:"font",dense:"",label:"End",mask:"##-##-#### ##:##"},model:{value:e.end,callback:function(a){t.$set(e,"end",a)},expression:"term.end"}})],1),a("p",{staticClass:"text-font full-width bg-tertiary q-mt-md q-pl-xs q-mb-none"},[t._v("Half Term")]),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-mr-xs",attrs:{color:"font",dense:"",label:"Start",mask:"##-##-#### ##:##"},model:{value:e.htStart,callback:function(a){t.$set(e,"htStart",a)},expression:"term.htStart"}}),a("q-input",{staticClass:"col q-ml-xs",attrs:{color:"font",dense:"",label:"End",mask:"##-##-#### ##:##"},model:{value:e.htEnd,callback:function(a){t.$set(e,"htEnd",a)},expression:"term.htEnd"}})],1),a("p",{staticClass:"text-font full-width bg-tertiary q-mt-md q-pl-xs q-mb-none"},[t._v("Exeat 1")]),a("div",{staticClass:"q-ml-md row"},[a("q-input",{staticClass:"col q-pr-xs",attrs:{color:"font",dense:"",label:"Start",mask:"##-##-#### ##:##"},model:{value:e.ex1Start,callback:function(a){t.$set(e,"ex1Start",a)},expression:"term.ex1Start"}}),a("q-input",{staticClass:"col q-ml-xs",attrs:{color:"font",dense:"",label:"End",mask:"##-##-#### ##:##"},model:{value:e.ex1End,callback:function(a){t.$set(e,"ex1End",a)},expression:"term.ex1End"}})],1),a("p",{staticClass:"text-font full-width bg-tertiary q-mt-md q-pl-xs q-mb-none"},[t._v("Exeat 2")]),a("div",{staticClass:"q-ml-md row"},[a("q-input",{staticClass:"col q-pr-xs",attrs:{color:"font",dense:"",label:"Start",mask:"##-##-#### ##:##"},model:{value:e.ex2Start,callback:function(a){t.$set(e,"ex2Start",a)},expression:"term.ex2Start"}}),a("q-input",{staticClass:"col q-ml-xs",attrs:{color:"font",dense:"",label:"End",mask:"##-##-#### ##:##"},model:{value:e.ex2End,callback:function(a){t.$set(e,"ex2End",a)},expression:"term.ex2End"}})],1)])],1)],1)],1)})),a("div",{staticClass:"q-mt-md"},[a("div",{staticClass:"row"},[a("q-input",{attrs:{dense:"",filled:"",mask:"##-##-####",rulesx:["date"]},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{mask:"DD-MM-YYYY"},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.testDate,callback:function(e){t.testDate=e},expression:"testDate"}})],1)],1)]},proxy:!0}]),model:{value:t.testDate,callback:function(e){t.testDate=e},expression:"testDate"}}),a("q-input",{staticClass:"col q-ml-xs",attrs:{color:"font",filled:"",dense:"",mask:"##:##"},model:{value:t.testTime,callback:function(e){t.testTime=e},expression:"testTime"}})],1),a("q-btn",{staticClass:"q-mt-md full-width",attrs:{label:"test",color:"font-secondary",outline:"",dense:""},on:{click:t.test}}),a("span",{staticClass:"q-pt-lg"},[t._v(t._s(t.testResponse))])],1)],2)])])},r=[],c=(a("c880"),a("4fb0"),a("2cc0")),i=a.n(c),d=a("4778"),m={getTerms:function(t,e,a){d["a"].get("/admin/school/terms/"+a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},putTerms:function(t,e,a){d["a"].put("/admin/school/terms",a).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getPeriod:function(t,e,a){d["a"].get("/admin/school/period/"+a.date+"/"+a.time).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}},u=a("134d"),p={name:"Component.Admin.School.Calendar",props:{},data:function(){return{terms:[],newModeOn:!0,calIndex:0,year:null,eventId:0,showWeeks:!1,testDate:null,testTime:"09:00",testResponse:""}},methods:{test:function(){var t=this;m.getPeriod((function(e){console.log(e),t.testResponse=e}),this.$errorHandler,{date:this.testDate,time:this.testTime})},clickDay:function(t,e){console.log(t)},changeYear:function(t){var e=t.currentYear;e!==this.year&&(this.year=e,m.getTerms(this.processTerms,this.$errorHandler,e))},processTerms:function(t){this.terms=t,this.calendarData()},makeDate:function(t){if(!t)return null;var e=t.split(" ")[0],a=e.split("-")[0],s=e.split("-")[1],n=e.split("-")[2];return new Date(n,s-1,a)},calendarData:function(){var t=[],e="black",a=this;return this.terms.forEach((function(s,n){var l=s.isPublished?a.$hexPalette(n):u["a"].getBrand("font-secondary");a.showWeeks||t.push({name:s.name,startDate:a.makeDate(s.start),endDate:a.makeDate(s.end),color:l}),t.push({startDate:a.makeDate(s.htStart),endDate:a.makeDate(s.htEnd),color:e}),t.push({startDate:a.makeDate(s.htStart),endDate:a.makeDate(s.htEnd),color:e}),t.push({startDate:a.makeDate(s.htStart),endDate:a.makeDate(s.htEnd),color:e}),t.push({startDate:a.makeDate(s.ex1Start),endDate:a.makeDate(s.ex1End),color:e}),t.push({startDate:a.makeDate(s.ex1Start),endDate:a.makeDate(s.ex1End),color:e}),t.push({startDate:a.makeDate(s.ex1Start),endDate:a.makeDate(s.ex1End),color:e}),t.push({startDate:a.makeDate(s.ex2Start),endDate:a.makeDate(s.ex2End),color:e}),t.push({startDate:a.makeDate(s.ex2Start),endDate:a.makeDate(s.ex2End),color:e}),t.push({startDate:a.makeDate(s.ex2Start),endDate:a.makeDate(s.ex2End),color:e}),a.showWeeks&&s.weeks.forEach((function(e,s){"B"!==e.type&&"A"!==e.type||t.push({startDate:a.makeDate(e.wb),endDate:a.makeDate(e.we),color:"B"===e.type?u["a"].getBrand("positive"):u["a"].getBrand("accent")})}))})),this.$refs.calendar.calendar&&this.$refs.calendar.calendar.setDataSource(t),t},save:function(){var t=this;m.putTerms((function(e){t.terms=e,t.calendarData()}),this.$errorHandler,this.terms)}},computed:{},components:{Calendar:i.a},watch:{terms:{deep:!0,handler:function(){}}},created:function(){this.calendarData()}},h=p,f=(a("2d70"),a("2be6")),x=a("e279"),D=a.n(x),k=a("8c42"),b=a("3d3c"),q=a("6c93"),v=a("0f3b"),g=a("ebe6"),C=a("965d"),w=a("2ef0"),S=a("bc74"),y=a("34ff"),E=a("8c18"),$=a("88af"),P=Object(f["a"])(h,o,r,!1,null,"371527de",null),T=P.exports;D()(P,"components",{QPage:k["a"],QToggle:b["a"],QList:q["a"],QExpansionItem:v["a"],QCard:g["a"],QCardSection:C["a"],QBtn:w["a"],QInput:S["a"],QIcon:y["a"],QPopupProxy:E["a"],QDate:$["a"]});var Q={name:"Page.Admin.School.Calendar",data:function(){return{elements:[{name:"calendar",label:"Calendar",component:T,shortcut:"s"}]}},components:{toolbarPage:l["a"]},methods:{refresh:function(){}}},_=Q,B=Object(f["a"])(_,s,n,!1,null,null,null);e["default"]=B.exports}}]);