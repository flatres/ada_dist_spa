(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[25],{"0261":function(t,e,s){"use strict";var a=s("15e5"),n=s.n(a);n.a},"15e5":function(t,e,s){},3377:function(t,e,s){},ab73:function(t,e,s){"use strict";var a=s("3377"),n=s.n(a);n.a},d497:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.getGlobalSubject?s("q-page",{},[s("exam-bar",{staticClass:"bg-tertiary",on:{loaded:function(e){t.showClasses=!0}}}),s("loading",{attrs:{loading:t.autoAssigning,messagex:t.autoCount+" / "+t.meetingsCount}}),!t.autoAssigning&&t.showClasses?s("div",{staticClass:"row full-width bg-secondary q-ma-md q-pl-md"},[s("div",{staticClass:"col"},[s("classes",{attrs:{classes:t.classes},on:{"update:classes":function(e){t.classes=e},publish:t.teachers}})],1),s("div",{staticClass:"ada-sidebar q-mx-sm"},[s("div",{staticClass:"full-width text-center bg-tertiary q-pb-lg"},[s("q-circular-progress",{staticClass:"text-white q-ma-md",attrs:{"show-value":"",value:t.progress,size:"90px",thickness:.2,color:"accent","center-color":"tertiary","track-color":"secondary",max:1}},[s("div",{staticClass:"absolute-full flex flex-center",staticStyle:{"font-size":"14px"}},[t._v("\n            "+t._s(t.bookedCount)+" / "+t._s(t.meetingsCount)+"\n          ")])]),s("div",{staticClass:"row full-width q-px-md q-mb-md"},[s("q-btn",{staticClass:"full-width",attrs:{outline:"",color:"accent",label:"Auto Assign"},on:{click:t.autoAssign}})],1),t.teachers.length>0?s("q-markup-table",{staticClass:"q-mx-md",attrs:{dense:"",flat:"",bordered:""}},[s("tbody",t._l(t.teachers,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[t._v(t._s(e.name))]),s("td",{staticClass:"text-left"},[t._v(t._s(e.count))])])})),0)]):t._e()],1)])]):t._e()],1):t._e()},n=[],i=(s("e125"),s("4823"),s("2e73"),s("dde3"),s("76d0"),s("0c1f"),s("288e"),s("8e9e")),o=s.n(i),c=s("10ac"),l=s("9ce4"),r=s("89cf"),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("loading",{attrs:{loading:t.loadingClasses}}),!t.loadingClasses&&t.show&&t.classes.length>0?s("div",{staticClass:"row no-wrap q-px-xs q-pt-xs text-left",staticStyle:{"padding-bottom":"200px"}},[s("div",{staticClass:"q-mr-md",staticStyle:{"min-width":"150px"}},[s("q-scroll-area",{staticStyle:{height:"80vh"}},[s("q-list",{staticClass:"no-padding"},t._l(t.classes,(function(e){return s("q-item",{key:e.code,staticClass:"q-pa-xs text-white bg-tertiary q-my-xs",class:e.id===t.selectedClassId?"active-class":"",style:e.id===t.selectedClassId?"border: 2px solid black":"border: 1px solid grey",attrs:{clickable:"",group:"classes",dense:""},on:{click:function(s){return t.setClass(e.id)}}},[s("q-item-section",[s("q-item-label",{staticClass:"xrow"},[s("q-btn",{staticClass:"fullx-width",attrs:{flat:"",color:"font",label:e.code,dense:"","no-caps":"",size:"12px"}})],1)],1),s("q-item-section",{attrs:{side:""}},[t.classComplete(e)?s("q-icon",{attrs:{name:"fad fa-check",color:"positive"}}):t._e()],1)],1)})),1)],1)],1),s("div",{staticClass:"col"},[s("loading",{attrs:{loading:t.loading}}),!t.loading&&t.selectedClass?s("q-markup-table",{attrs:{dense:"",flat:"",bordered:""}},[s("thead",{staticClass:"q-mb-md"},[s("tr",{staticClass:"bg-tertiary"},[s("th",{staticClass:"text-left"},[t._v("Name")]),s("th",{staticClass:"text-left"},[t._v("Class")]),s("th",[t._v("Meeting Beak\n            ")])])]),s("tbody",t._l(t.selectedClass.students,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"text-left"},[t._v(t._s(e.fullName))]),s("td",{staticClass:"text-left"},[t._v(t._s(t.classCode))]),s("td",[s("q-btn-toggle",{staticClass:"no-shadow",attrs:{spread:"",outline:!e.meetingBeakId,dense:"","no-caps":"","toggle-color":"tertiary",color:"secondary","text-color":e.meetingBeakId?"grey-5":"warning",options:t.beakOptions},on:{input:function(s){return t.setBeak(e)}},model:{value:e.meetingBeakId,callback:function(s){t.$set(e,"meetingBeakId",s)},expression:"s.meetingBeakId"}})],1)])})),0)]):t._e()],1)]):t._e()],1)},d=[],g=s("4778"),h=s("452d"),f={getMeetingClasses:function(t,e){var s=h["a"].getters["user/getGlobalSubject"],a=12,n=h["a"].getters["hod/activeExam"];s&&n&&g["a"].get("/hod/meetings/"+s.id+"/"+a+"/"+n).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},setMeeting:function(t,e,s,a,n){var i=h["a"].getters["user/getGlobalSubject"],o=h["a"].getters["hod/activeExam"];i&&o&&g["a"].post("/hod/meetings/"+i.id+"/"+o+"/"+s+"/"+a+"/"+n).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))}},m={name:"HOD.Data.MLO",props:{},data:function(){return{year:null,exam:null,subject:null,students:[],maxMLOCount:4,classes:[],selectedClassId:null,selectedClass:null,show:!1,exams:[],teachers:[],loading:!1,loadingClasses:!0}},methods:{classComplete:function(t){var e=t.students.filter((function(t){return t.meetingBeakId})).length;return e===t.students.length},setBeak:function(t){f.setMeeting(this.publish,this.$errorHandler,t.id,t.meetingBeakId,t.classId),console.log(t)},publish:function(){this.$emit("update:classes",this.classes)},processClasses:function(t){this.classes=t,this.loadingClasses=!1,this.classes.length>0&&(this.show=!0,this.setClass(this.classes[0].id)),this.publish()},getMeetingClasses:function(){this.loadingClasses=!0,f.getMeetingClasses(this.processClasses,this.$errorFunction)},setClass:function(t){this.selectedClassId=t,this.selectedClass=this.classes.find((function(e){return e.id===t}))}},computed:{classCode:function(){return this.selectedClass.code},beakOptions:function(){var t=this.selectedClass.teachers.map((function(t){return{label:t.login,value:t.id}}));return console.log(t),t}},components:{Loading:c["a"]},mounted:function(){this.getMeetingClasses()},created:function(){var t=this;this.subject=this.$store.getters["user/getGlobalSubject"],this.subjectWatch=this.$store.watch((function(){return t.$store.getters["user/getGlobalSubject"]}),this.getMeetingClasses),this.yearWatch=this.$store.watch((function(){return t.$store.getters["hod/activeYear"]}),this.getMeetingClasses),this.examWatch=this.$store.watch((function(){return t.$store.getters["hod/activeExam"]}),this.getMeetingClasses)},beforeDestroy:function(){this.subjectWatch(),this.yearWatch(),this.examWatch()}},b=m,p=(s("0261"),s("2be6")),C=s("26a8"),v=s("6c93"),x=s("ac9b"),k=s("66dc"),y=s("7d9a"),w=s("2ef0"),q=s("34ff"),O=s("2e0b"),_=s("6dd6"),j=s("e279"),I=s.n(j),B=Object(p["a"])(b,u,d,!1,null,"636ffe52",null),A=B.exports;function M(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function $(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?M(Object(s),!0).forEach((function(e){o()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):M(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}I()(B,"components",{QScrollArea:C["a"],QList:v["a"],QItem:x["a"],QItemSection:k["a"],QItemLabel:y["a"],QBtn:w["a"],QIcon:q["a"],QMarkupTable:O["a"],QBtnToggle:_["a"]});var E={name:"Page.HOD.Meetings",data:function(){return{classes:[],autoAssigning:!1,autoCount:0,showClasses:!1}},computed:$($({},Object(l["c"])("user",["getGlobalSubject"])),{},{meetingsCount:function(){var t=0;return this.classes.forEach((function(e){t+=e.students.length})),t},bookedCount:function(){var t=0;return this.classes.forEach((function(e){t+=e.students.filter((function(t){return t.meetingBeakId})).length})),t},teachers:function(){var t=[];return this.classes.forEach((function(e){e.students.forEach((function(s){var a=t.find((function(t){return t.id===s.meetingBeakId}));if(a)a.count++;else{var n=e.teachers.find((function(t){return t.id===s.meetingBeakId}));n&&t.push({name:n.login,id:n.id,count:1})}}))})),t.sort(this.$compare("name")),t},progress:function(){return 0===this.meetingsCount?0:this.bookedCount/this.meetingsCount}}),methods:$($({},Object(l["d"])("hod",["setActiveYear"])),{},{autoAssign:function(){var t=this;this.$q.dialog({title:"Confirm",message:"Would you like to automatically assign beaks to pupils?",cancel:!0,persistent:!0}).onOk((function(){t.doAutoAssign()})).onOk((function(){})).onCancel((function(){})).onDismiss((function(){}))},doAutoAssign:function(){var t=this;this.autoAssigning=!0,this.autoCount=0,this.classes.forEach((function(e){var s=0,a=e.teachers.length;e.students.forEach((function(n){var i=e.teachers[s%a].id;f.setMeeting((function(e){n.meetingBeakId=i,t.autoCount++,1===t.progress&&(t.autoAssigning=!1)}),t.$errorHandler,n.id,i,e.id),s++}))})),console.log(this.classes)}}),components:{ExamBar:r["a"],Classes:A,Loading:c["a"]},created:function(){this.setActiveYear(12)},beforeDestroy:function(){}},S=E,Q=(s("ab73"),s("8c42")),P=s("cf19"),D=Object(p["a"])(S,a,n,!1,null,null,null);e["default"]=D.exports;I()(D,"components",{QPage:Q["a"],QCircularProgress:P["a"],QBtn:w["a"],QMarkupTable:O["a"]})}}]);