(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["8d4d9510"],{"0693":function(t,e,o){"use strict";var n=o("6139"),s=o.n(n);s.a},"08ab":function(t,e,o){},"08e9":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-page",{staticClass:"no-scroll toolbar-page"},[o("q-toolbar",{class:{"text-white bg-toolbar":t.isDark,"text-black bg-white-3":t.isLight},attrs:{dense:"",shrink:"",classx:"text-white shadow-2 rounded-borders narrowx justify"}},[t._t("before"),o("q-tabs",{staticClass:"tbp-tabs",attrs:{dense:"",shrink:"","active-color":t.isLight?"#011b48":"primary"},model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},t._l(t.elements,(function(e){return o("div",{key:e.name},[e.menu?t._e():o("q-tab",{attrs:{label:e.label,name:e.name,icon:e.icon}},[e.count>0?o("q-badge",{attrs:{color:"lime-13","text-color":"black",floating:""}},[t._v(t._s(e.count))]):t._e(),e.tooltip?o("q-tooltip",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[t._v("\n             "+t._s(e.tooltip)+"\n           ")]):t._e()],1),e.menu?o("q-btn",{attrs:{flat:"",size:"sm",label:e.label,icon:e.icon?e.icon:"fal fa-caret-down","text-color":t.isDark?"white":"primary"}},[o("q-menu",{ref:"settingsPopover",refInFor:!0,attrs:{"content-class":"bg-grey-9 text-white","auto-close":""}},[o("q-list",{attrs:{"item-separator":"",link:"","content-class":"bg-primary"}},t._l(e.menu,(function(e){return o("q-item",{key:e.name,attrs:{clickable:""},nativeOn:{click:function(o){return t.clickMenu(e)}}},[o("q-item-section",{attrs:{avatar:"",left:"",dark:""}},[o("q-icon",{attrs:{size:"20px",name:e.icon}})],1),o("q-item-section",[o("q-item-label",[t._v(t._s(e.label))])],1)],1)})),1)],1)],1):t._e()],1)})),0),o("q-space"),t._t("side"),t._t("after")],2),o("q-tab-panels",{model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},t._l(t.tabPanels,(function(e){return o("q-tab-panel",{key:e.name,attrs:{name:e.name}},[o(e.component,{tag:"component",on:{close:t.close}})],1)})),1)],1)},s=[],a=(o("e125"),o("4823"),o("2e73"),o("dde3"),o("76d0"),o("0c1f"),o("c880"),o("8e9e")),c=o.n(a),i=o("9ce4");function l(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function r(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(Object(o),!0).forEach((function(e){c()(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var u={name:"ComponentPageToolbar",props:{default:null,elements:null},watch:{selectedTab:function(){console.log(":",this.selectedTab)}},data:function(){return{selectedTab:null}},computed:r({},Object(i["e"])("user",["isDark","isLight"]),{tabPanels:function(){var t=[];return this.elements.forEach((function(e){e.menu?e.menu.forEach((function(e){t.push({name:e.name,component:e.component})})):t.push({name:e.name,component:e.component})})),t}}),methods:{close:function(){this.selectedTab=this.default},clickMenu:function(t){t.name&&(this.selectedTab=t.name),t.event&&this.$emit(t.event)}},created:function(){this.selectedTab=this.default}},d=u,p=(o("b0d4"),o("2be6")),f=Object(p["a"])(d,n,s,!1,null,null,null);e["a"]=f.exports},"423b":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"row"},[o("div",{staticClass:"col-4 text-left q-mx-xs",staticStyle:{border:"1px solid grey"}},[o("q-tabs",{staticClass:"bg-toolbar text-primary no-shadow",attrs:{dense:"",align:"left",breakpoint:0},model:{value:t.direction,callback:function(e){t.direction=e},expression:"direction"}},[o("q-tab",{attrs:{name:"outbound",label:"outbound",icon:"fal fa-arrow-square-right"}}),o("q-tab",{attrs:{name:"return",label:"return",icon:"fal fa-arrow-square-left"}})],1),o("div",{staticClass:"q-pa-md text-white"},[o("q-list",{attrs:{dark:"",bordered:"",separator:"",stylex:"max-width: 318px"}},t._l(t.activeRoutes,(function(e){return o("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,class:t.selectedRoute.id===e.id?"bg-toolbar highlight":"",attrs:{clickable:"","expand-separator":"",iconx:"perm_identity",label:e.name},on:{click:function(o){return t.selectRoute(e)}}},[o("q-item-section",[o("span",[t._v("\n              "+t._s(e.name)+"\n              ")])]),o("q-item-section",{staticClass:"row",attrs:{side:""}},[o("span",[t.locked?t._e():o("edit-button",{attrs:{model:e,field:"name",success:t.saveRoute}}),t.locked?t._e():o("delete-button",{attrs:{model:e,success:t.deleteRoute,label:"Delete Route?"}})],1)])],1)})),1),t.locked?t._e():o("new-button",{staticClass:"q-mt-md",attrs:{success:t.submitNew,label:"New Route Name"}})],1)],1),o("div",{staticClass:"col text-left q-mx-xs bg-dark",staticStyle:{border:"1px solid grey"}},[o("q-bar",{staticClass:"text-primary bg-toolbar"},[t._v(t._s(t.selectedRoute.name))]),t.selectedRoute.id?o("q-card",{staticClass:"no-shadow"},[o("q-card-section",{staticClass:"row bg-dark no-shadow"},[o("div",{staticClass:"col q-mr-md"},[o("q-bar",{staticClass:"text-grey text-bold q-mb-xs no-shadow no-border",staticStyle:{background:"none"}},[o("span",{staticClass:"q-mr-md"},[t._v("Coaches")]),t.locked?t._e():o("new-button-double",{staticClass:"q-mt-sm q-mb-sm q-ml-lg",attrs:{success:t.newCoach,label:"Bus Code",label2:"New Coach Capacity?",type2:"number"}})],1),o("q-list",{attrs:{bordered:""}},t._l(t.selectedRoute.coaches,(function(e){return o("q-expansion-item",{key:e.id,staticClass:"bg-toolbar q-mb-sm",scopedSlots:t._u([{key:"header",fn:function(){return[o("q-item-section",{attrs:{avatar:""}},[o("q-icon",{attrs:{color:"primary",name:"fal fa-bus"}})],1),o("q-item-section",{staticClass:"text-white row"},[o("q-item-label",{attrs:{lines:"1"}},[t._v(t._s(e.code))]),o("q-item-label",{staticClass:"text-white",attrs:{caption:""}},[t._v(t._s(e.capacity)+" seats  ---  "+t._s(e.activeCount)+" stops")])],1),o("q-item-section",{staticClass:"row",attrs:{side:""}},[o("span",{staticClass:"text-white"},[t.locked?t._e():o("edit-button",{attrs:{model:e,field:"code",icon:"fal fa-tag",success:t.saveCoach,tooltip:"Change Bus Code"}}),t.locked?t._e():o("edit-button",{attrs:{model:e,type:"number",field:"capacity",icon:"fal fa-users",success:t.saveCoach,tooltip:"Change Capacity"}}),t.locked?t._e():o("delete-button",{attrs:{tooltip:"Delete Coach",model:e,success:t.deleteCoach,label:"Delete Coach?"}})],1)])]},proxy:!0}],null,!0)},[o("q-card",{staticStyle:{"border-top":"1px solid grey"}},[o("q-card-section",{staticClass:"bg-toolbar text-white"},[o("q-list",[o("q-item",{attrs:{tagx:"label"}},[o("q-item-section",{attrs:{avatar:""}},t._l(e.stops,(function(n){return n.isSchoolLocation?t._e():o("q-checkbox",{key:n.id,staticClass:"row",attrs:{dark:"",label:n.name,color:"primary"},on:{input:function(o){return t.clickCoachStop(e,n)}},model:{value:n.isActive,callback:function(e){t.$set(n,"isActive",e)},expression:"stop.isActive"}})})),1)],1)],1)],1)],1)],1)})),1)],1),o("div",{staticClass:"col q-pl-md",staticStyle:{"border-left":"1px solid grey"}},[o("q-bar",{staticClass:"text-grey text-bold",staticStyle:{background:"none"}},[t._v("Route")]),o("q-timeline",{attrs:{layoutx:"dense",side:"right",color:"primary"}},t._l(t.selectedRoute.stops,(function(e){return o("q-timeline-entry",{key:e.id,attrs:{title:e.name,subtitle:e.time,side:"left"}},[o("span",{staticClass:"no-shadow",staticStyle:{"margin-top":"-30px"}},[t.locked?t._e():o("edit-button",{attrs:{model:e,field:"name",success:t.saveStop,tooltip:"Edit Stop Name"}}),t.locked||0!==e.isSchoolLocation?t._e():o("edit-button",{attrs:{model:e,type:"time",field:"time",icon:"fal fa-clock",success:t.saveStop,tooltip:"Change Time (affects stop order)"}}),t.locked||0!==e.isSchoolLocation?t._e():o("delete-button",{attrs:{model:e,success:t.deleteStop,label:"Delete Stop?",tooltip:"delete stop"}})],1),0===e.isSchoolLocation?o("div",{staticClass:"row q-mt-sm"},[o("div",{staticClass:"col"},[o("q-badge",{attrs:{"text-color":0===e.cost?"black":"white",color:0===e.cost?"red-7":"grey-9"}},[t._v("Â£ "+t._s(e.cost)+"\n                    ")]),t.locked?t._e():o("edit-button",{staticClass:"q-ml-md",attrs:{model:e,field:"cost",icon:"fal fa-credit-card",success:t.saveStop,tooltip:"Set Price"}})],1)]):t._e()])})),1),t.locked?t._e():o("new-button",{attrs:{label:"New stop name",success:t.newStop}})],1)])],1):t._e()],1)])},s=[],a=(o("e125"),o("4823"),o("2e73"),o("dde3"),o("76d0"),o("0c1f"),o("8e9e")),c=o.n(a),i=(o("ce9c"),o("9ce4")),l=o("5228"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-btn",{staticClass:"col",attrs:{size:t.size,flat:"",dense:"",icon:t.icon},on:{click:function(t){t.stopPropagation()}}},[t.tooltip?o("q-tooltip",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[t._v("\n     "+t._s(t.tooltip)+"\n   ")]):t._e(),o("q-popup-proxy",[o("q-card",{staticClass:"bg-blue-grey-9",staticStyle:{width:"200px"},attrs:{dark:""}},[o("q-card-section",[t._v("\n        "+t._s(t.label)+"\n      ")]),o("q-separator",{attrs:{dark:"",inset:""}}),o("q-card-section",{staticClass:"row q-gutter-sm"},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"col",attrs:{color:"pink",label:"No"}}),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"col",attrs:{color:"lime-13","text-color":"black",label:"Yes"},on:{click:function(e){return t.success(t.model)}}})],1)],1)],1)],1)},u=[],d={name:"Component.Buttons.Delete",props:{success:{type:Function,required:!0},model:{type:Object,required:!0},size:{type:String,default:"sm"},icon:{type:String,default:"fal fa-trash"},label:{type:String,default:"Delete"},tooltip:{type:String}},data:function(){return{}},methods:{},computed:{},components:{},created:function(){}},p=d,f=(o("8eb9"),o("2be6")),b=Object(f["a"])(p,r,u,!1,null,"14a00ef9",null),h=b.exports,m=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-btn",{attrs:{size:t.size,icon:t.icon,outline:"",color:"primary",dense:""},on:{click:function(t){t.stopPropagation()}}},[t.tooltip?o("q-tooltip",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[t._v("\n     "+t._s(t.tooltip)+"\n   ")]):t._e(),o("q-popup-proxy",{ref:"popup"},[o("q-banner",{staticClass:"bg-dark text-white q-pt-md",staticStyle:{border:"1px solid grey"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()}}},[o("q-input",{attrs:{label:t.label,type:t.type,dark:"",autofocus:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"full-width highlight q-mt-md",attrs:{disabled:0===t.name.length,outline:"",label:"submit"},on:{click:function(e){return t.submit()}}})],1)],1)],1)},g=[],y=(o("c880"),{name:"Component.Buttons.New",props:{success:{type:Function,required:!0},size:{type:String,default:"xs"},icon:{type:String,default:"fal fa-plus"},label:{type:String,default:"New"},type:{type:String,default:""},tooltip:{type:String}},data:function(){return{name:""}},methods:{submit:function(){0!==this.name.length&&(this.success(this.name),this.name="",this.$refs.popup.hide())}},computed:{},components:{},created:function(){}}),v=y,q=(o("e004"),Object(f["a"])(v,m,g,!1,null,"512b507a",null)),w=q.exports,k=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-btn",{attrs:{size:t.size,icon:t.icon,outline:"",color:"primary",dense:""}},[t.tooltip?o("q-tooltip",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[t._v("\n     "+t._s(t.tooltip)+"\n   ")]):t._e(),o("q-popup-proxy",{ref:"popup"},[o("q-banner",{staticClass:"bg-dark text-white q-pt-md",staticStyle:{border:"1px solid grey"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit()}}},[o("q-input",{attrs:{label:t.label,type:t.type,dark:"",autofocus:""},model:{value:t.data,callback:function(e){t.data=e},expression:"data"}}),o("q-input",{attrs:{label:t.label2,type:t.type2,dark:""},model:{value:t.data2,callback:function(e){t.data2=e},expression:"data2"}}),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"full-width highlight q-mt-md",attrs:{disabled:0===t.data.length||0===t.data2.length,outline:"",label:"submit"},on:{click:function(e){return t.submit()}}})],1)],1)],1)},_=[],C={name:"Component.Buttons.New",props:{success:{type:Function,required:!0},size:{type:String,default:"xs"},icon:{type:String,default:"fal fa-plus"},label:{type:String,default:"New"},type:{type:String,default:""},label2:{type:String,default:"New"},type2:{type:String,default:""},tooltip:{type:String}},data:function(){return{data:"",data2:""}},methods:{submit:function(){0!==this.data.length&&0!==this.data2.length&&(this.success(this.data,this.data2),this.data="",this.data2="",this.$refs.popup.hide())}},computed:{},components:{},created:function(){}},x=C,S=(o("cb4b"),Object(f["a"])(x,k,_,!1,null,"f9c3affe",null)),R=S.exports,O=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-btn",{staticClass:"col q-mr-md",attrs:{size:t.size,flat:"",dense:"",icon:t.icon},on:{click:function(t){t.stopPropagation()}}},[t.tooltip?o("q-tooltip",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[t._v("\n     "+t._s(t.tooltip)+"\n   ")]):t._e(),o("q-popup-edit",{on:{save:function(e){return t.success(t.model)},hide:function(e){return t.success(t.model)}},model:{value:t.model[t.field],callback:function(e){t.$set(t.model,t.field,e)},expression:"model[field]"}},[o("q-input",{attrs:{type:t.type,dark:"",dense:"",autofocus:""},model:{value:t.model[t.field],callback:function(e){t.$set(t.model,t.field,e)},expression:"model[field]"}})],1)],1)},j=[],P={name:"Component.Buttons.Edit",props:{success:{type:Function,required:!0},model:{type:Object,required:!0},field:{type:String,required:!0},size:{type:String,default:"sm"},icon:{type:String,default:"fal fa-edit"},title:{type:String,default:"Edit"},type:{type:String,default:""},tooltip:{type:String}},data:function(){return{name:""}},methods:{},computed:{},components:{},created:function(){}},N=P,D=(o("95ab"),Object(f["a"])(N,O,j,!1,null,"bd074fb8",null)),E=D.exports;function T(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function $(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?T(Object(o),!0).forEach((function(e){c()(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):T(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var I={name:"Tbs.Coaches.Setup",props:{session:{type:Number},locked:{type:Boolean,default:!1}},data:function(){return{direction:"outbound",routes:[],selectedRouteId:null,selectedRoute:{id:null,name:null},newName:"",temp:!1}},methods:{clickCoachStop:function(t,e){console.warn(t,e);var o={coachId:t.id,stopId:e.id,isActive:e.isActive};l["a"].putCoachStop(this.getRoute,this.$error,o)},getRoutes:function(){l["a"].getRoutes(this.processRoutes,null,this.session)},saveRoute:function(t){l["a"].putRoute(this.getRoutes,null,t)},deleteRoute:function(t){l["a"].deleteRoute(this.getRoutes,null,t.id),t.id===this.selectedRouteId&&(this.selectedRouteId=null,this.selectedRoute={id:null,name:null})},setSession:function(){},processRoutes:function(t){this.routes=t,this.setTopActive()},selectRoute:function(t){t.id!==this.selectedRouteId&&(this.selectedRoute=t,this.selectedRouteId=t.id)},submitNew:function(t){var e=this;this.$q.loading.show();var o={name:t,sessionId:this.session,isReturn:this.isReturn};l["a"].postRoute((function(t){e.selectedRoute=t,e.selectedRouteId=t.id,e.getRoutes(),e.$q.loading.hide()}),null,o)},newStop:function(t){l["a"].postStop(this.getRoute,null,{routeId:this.selectedRouteId,name:t})},saveStop:function(t){l["a"].putStop(this.getRoute,null,t)},deleteStop:function(t){l["a"].deleteStop(this.getRoute,null,t.id)},getRoute:function(){var t=this,e=this.selectedRouteId;l["a"].getRoute((function(e){console.log(e),t.selectedRoute=e}),null,e)},newCoach:function(t,e){l["a"].postCoach(this.getRoute,null,{routeId:this.selectedRouteId,code:t,capacity:e})},saveCoach:function(t){l["a"].putCoach(this.getRoute,null,t)},deleteCoach:function(t){l["a"].deleteCoach(this.getRoute,null,t.id)},setTopActive:function(){var t=this.activeRoutes[0];this.selectedRouteId=t.id,this.selectedRoute=t}},watch:{selectedRouteId:function(){this.getRoute()},session:function(){this.getRoutes()},direction:function(){this.setTopActive()}},computed:$({},Object(i["c"])("transport",["activeSession"]),{isReturn:function(){return"outbound"===this.direction?0:1},countActiveStops:function(t){var e=t.stops.filter((function(t){return t.isActive}));return e.length},activeRoutes:function(){var t=this,e=this.routes.filter((function(e){return e.isReturn===t.isReturn}));return e}}),components:{DeleteButton:h,NewButton:w,NewButtonDouble:R,EditButton:E},created:function(){var t=this;0!==this.session&&(this.$store.watch((function(){return t.$store.getters["transport/activeSession"]}),this.setSession),this.session=this.$store.getters["transport/activeSession"]),this.getRoutes()}},z=I,B=(o("0693"),Object(f["a"])(z,n,s,!1,null,"3f72ba0f",null));e["a"]=B.exports},5228:function(t,e,o){"use strict";var n=o("4778");e["a"]={getRoutes:function(t,e,o){n["a"].get("/transport/coaches/routes/"+o).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getStops:function(t,e,o){n["a"].get("/transport/coaches/stops/"+o).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},getRoute:function(t,e,o){n["a"].get("/transport/coaches/route/"+o).then((function(e){t(e.data)})).catch((function(t){console.log(t)}))},postRoute:function(t,e,o){n["a"].post("/transport/coaches/route",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},putRoute:function(t,e,o){n["a"].put("/transport/coaches/route",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},deleteRoute:function(t,e,o){n["a"].delete("/transport/coaches/route/"+o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},postCoach:function(t,e,o){n["a"].post("/transport/coaches/coach",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},putCoach:function(t,e,o){n["a"].put("/transport/coaches/coach",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},deleteCoach:function(t,e,o){n["a"].delete("/transport/coaches/coach/"+o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},postStop:function(t,e,o){n["a"].post("/transport/coaches/stop",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},putStop:function(t,e,o){n["a"].put("/transport/coaches/stop",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},deleteStop:function(t,e,o){n["a"].delete("/transport/coaches/stop/"+o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},putCoachStop:function(t,e,o){n["a"].put("/transport/coaches/coach/stop",o).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))},postCopyRoutes:function(t,e,o,s){n["a"].post("/transport/coaches/copy/"+o+"/"+s).then((function(e){t(e.data)})).catch((function(t){console.log(t),e()}))}}},"58bc":function(t,e,o){},6139:function(t,e,o){},"8eb9":function(t,e,o){"use strict";var n=o("08ab"),s=o.n(n);s.a},"95ab":function(t,e,o){"use strict";var n=o("baa9"),s=o.n(n);s.a},b0d4:function(t,e,o){"use strict";var n=o("b3f7"),s=o.n(n);s.a},b3f7:function(t,e,o){},baa9:function(t,e,o){},cb4b:function(t,e,o){"use strict";var n=o("f806"),s=o.n(n);s.a},e004:function(t,e,o){"use strict";var n=o("58bc"),s=o.n(n);s.a},f806:function(t,e,o){}}]);